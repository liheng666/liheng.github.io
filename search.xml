<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>è®°mysqlè¯­å¥æ‰§è¡Œå µå¡æ’æŸ¥</title>
      <link href="/2020/08/25/%E8%AE%B0mysql%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E5%A0%B5%E5%A1%9E%E6%8E%92%E6%9F%A5/"/>
      <url>/2020/08/25/%E8%AE%B0mysql%E8%AF%AD%E5%8F%A5%E6%89%A7%E8%A1%8C%E5%A0%B5%E5%A1%9E%E6%8E%92%E6%9F%A5/</url>
      <content type="html"><![CDATA[<h2 id="å…ˆè¯´åŸå› "><a href="#å…ˆè¯´åŸå› " class="headerlink" title="å…ˆè¯´åŸå› "></a>å…ˆè¯´åŸå› </h2><p>æµ‹è¯•ç¯å¢ƒçš„binlog æ²¡æœ‰è‡ªåŠ¨åˆ é™¤ï¼Œå¯¼è‡´ç£ç›˜å æ»¡ï¼Œè¯·æ±‚çš„ sqlå…¨éƒ½å µå¡ï¼Œäº‹åŠ¡é”åˆè¿›ä¸€æ­¥å½±å“åˆ°åç»­çš„äº‹åŠ¡ï¼ŒæŠ¥<code>Lock wait timeout exceeded</code>,å¤§éƒ¨åˆ†äº‹åŠ¡state éƒ½æ˜¯ commitã€startingã€queryã€‚):</p><h2 id="æ’æŸ¥"><a href="#æ’æŸ¥" class="headerlink" title="æ’æŸ¥"></a>æ’æŸ¥</h2><ol><li>æ—¥å¿—æŠ¥é”™ <code>Lock wait timeout exceeded</code><br>é¦–å…ˆæƒ³åˆ°æ˜¯äº‹åŠ¡æ­»é”äº†ä½¿ç”¨<code>SELECT * FROM information_schema.INNODB_TRX;</code>æŸ¥çœ‹æ­£åœ¨æ‰§è¡Œçš„äº‹åŠ¡ï¼Œå‘ç°å…¨æ˜¯stateçŠ¶æ€å¤§éƒ¨åˆ†éƒ½æ˜¯ commitã€startingã€queryï¼Œè€Œä¸æ˜¯é”ç­‰å¾…çŠ¶æ€ï¼Œå¹¶ä¸”æ‰§è¡Œå¾ˆé•¿æ—¶é—´äº†ã€‚ç„¶å<code>show processlist</code> æŸ¥çœ‹çº¿ç¨‹ï¼Œä¹Ÿæ˜¯å‘ç°å¤§é‡çš„çº¿ç¨‹ï¼ŒåŸºæœ¬ä¸€ä¸ªäº‹åŠ¡å¯¹åº”ä¸€ä¸ªçº¿ç¨‹ï¼Œå…¨éƒ½å µå¡åœ¨é‚£ã€‚å¾ˆå¥‡æ€ªï¼Œæ²¡æ­»é”åˆå…¨åœ¨ç­‰å¾…ã€‚ æ²¡æ€è·¯äº†ã€‚ã€‚ã€‚ å…ˆæŠŠçº¿ç¨‹éƒ½killæ‰ï¼Œæµ‹è¯•ä¸‹æ­£å¸¸äº†ï¼Œç„¶ååˆä¼šæ…¢æ…¢å‡ºç°ç­‰å¾…çš„äº‹åŠ¡ã€‚</li><li>æ±‚åŠ©æœç´¢å¼•æ“ï¼Œæœ‰ç§å¯èƒ½æ˜¯ æ•°æ®ç›˜å†™æ»¡äº†æ‰€ä»¥éƒ½åœ¨ç­‰å¾…ï¼Œ<code>du -f</code>æœç„¶æ˜¯ç£ç›˜æ»¡äº†ï¼Œç„¶åå°±å‘ç°æ˜¯binlogæ²¡è‡ªåŠ¨åˆ é™¤ï¼Œå æ»¡äº†ç£ç›˜ï¼Œæ¸…é™¤éƒ¨åˆ†binlogåï¼Œæ­£å¸¸äº†ã€‚</li><li><code>/etc/my.cnf</code> è®¾ç½® <code>expire_logs_days = 15</code> ä¿ç•™15å¤©çš„ã€‚</li></ol>]]></content>
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> binlog </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>rustç¬”è®°1</title>
      <link href="/2019/10/17/rust%E7%AC%94%E8%AE%B01/"/>
      <url>/2019/10/17/rust%E7%AC%94%E8%AE%B01/</url>
      <content type="html"><![CDATA[<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>åœ¨ Linux æˆ– macOS ä¸Šå®‰è£… rustup<br>å¦‚æœä½ ä½¿ç”¨ Linux æˆ– macOSï¼Œæ‰“å¼€ç»ˆç«¯å¹¶è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://sh.rustup.rs -sSf | sh</span><br></pre></td></tr></table></figure><p>æ­¤å‘½ä»¤ä¸‹è½½ä¸€ä¸ªè„šæœ¬å¹¶å¼€å§‹å®‰è£… rustup å·¥å…·ï¼Œè¿™ä¼šå®‰è£…æœ€æ–°ç¨³å®šç‰ˆ Rustã€‚è¿‡ç¨‹ä¸­å¯èƒ½ä¼šæç¤ºä½ è¾“å…¥å¯†ç ã€‚å¦‚æœå®‰è£…æˆåŠŸï¼Œå°†ä¼šå‡ºç°å¦‚ä¸‹å†…å®¹ï¼š</p><blockquote><p>Rust is installed now. Great!</p></blockquote><p>è¦æ£€æŸ¥æ˜¯å¦æ­£ç¡®å®‰è£…äº† Rustï¼Œæ‰“å¼€ shell å¹¶è¿è¡Œå¦‚ä¸‹è¡Œï¼š</p><p><code>rustc --version</code></p><p>ä½ åº”èƒ½çœ‹åˆ°å·²å‘å¸ƒçš„æœ€æ–°ç¨³å®šç‰ˆçš„ç‰ˆæœ¬å·ã€æäº¤å“ˆå¸Œå’Œæäº¤æ—¥æœŸï¼Œæ˜¾ç¤ºä¸ºå¦‚ä¸‹æ ¼å¼ï¼š</p><blockquote><p>rustc x.y.z (abcabcabc yyyy-mm-dd)</p></blockquote><h2 id="æ›´æ–°ã€åˆ é™¤"><a href="#æ›´æ–°ã€åˆ é™¤" class="headerlink" title="æ›´æ–°ã€åˆ é™¤"></a>æ›´æ–°ã€åˆ é™¤</h2><p>æ›´æ–°å’Œå¸è½½<br>é€šè¿‡ rustup å®‰è£…äº† Rust ä¹‹åï¼Œå¾ˆå®¹æ˜“æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ã€‚åœ¨ shell ä¸­è¿è¡Œå¦‚ä¸‹æ›´æ–°è„šæœ¬ï¼š</p><p><code>rustup update</code></p><p>ä¸ºäº†å¸è½½ Rust å’Œ rustupï¼Œåœ¨ shell ä¸­è¿è¡Œå¦‚ä¸‹å¸è½½è„šæœ¬:</p><p><code>rustup self uninstall</code></p><h2 id="hello-rust"><a href="#hello-rust" class="headerlink" title="hello rust"></a>hello rust</h2><p>åˆ›å»ºæ–‡ä»¶<code>main.rs</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fn main()&#123;</span><br><span class="line">    println!(&quot;hello, rust&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¼–è¯‘ï¼š<code>rustc main.rs</code></p><p>è¿è¡Œï¼š<code>./main</code></p><p>çœ‹åˆ°ç»ˆç«¯æ‰“å°å‡ºæ¥:</p><blockquote><p>Hello, rust</p></blockquote><p>æ­å–œä½ æˆåŠŸäº†ï¼ï¼ï¼</p><h2 id="Cargo"><a href="#Cargo" class="headerlink" title="Cargo"></a>Cargo</h2><p>Cargo æ˜¯ Rust çš„æ„å»ºç³»ç»Ÿå’ŒåŒ…ç®¡ç†å™¨ã€‚</p><p>å¯ä»¥åœ¨ç»ˆç«¯è¾“å…¥å¦‚ä¸‹å‘½ä»¤æ£€æŸ¥æ˜¯å¦å®‰è£…äº† Cargoï¼š</p><p><code>cargo --version</code></p><p>å¦‚æœä½ çœ‹åˆ°äº†ç‰ˆæœ¬å·ï¼Œè¯´æ˜å·²å®‰è£…ï¼</p><h3 id="ä½¿ç”¨-Cargo-åˆ›å»ºé¡¹ç›®"><a href="#ä½¿ç”¨-Cargo-åˆ›å»ºé¡¹ç›®" class="headerlink" title="ä½¿ç”¨ Cargo åˆ›å»ºé¡¹ç›®"></a>ä½¿ç”¨ Cargo åˆ›å»ºé¡¹ç›®</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cargo new hello_cargo</span><br><span class="line">cd hello_cargo</span><br></pre></td></tr></table></figure><h3 id="Cargoç¼–è¯‘é¡¹ç›®"><a href="#Cargoç¼–è¯‘é¡¹ç›®" class="headerlink" title="Cargoç¼–è¯‘é¡¹ç›®"></a>Cargoç¼–è¯‘é¡¹ç›®</h3><p>å¯ä»¥ä½¿ç”¨ <code>cargo build</code> æˆ– <code>cargo check</code> æ„å»ºé¡¹ç›®ã€‚<br>å¯ä»¥ä½¿ç”¨ <code>cargo run</code> ä¸€æ­¥æ„å»ºå¹¶è¿è¡Œé¡¹ç›®ã€‚<br>æœ‰åˆ«äºå°†æ„å»ºç»“æœæ”¾åœ¨ä¸æºç ç›¸åŒçš„ç›®å½•ï¼ŒCargo ä¼šå°†å…¶æ”¾åˆ° <strong>target/debug</strong> ç›®å½•ã€‚</p><h3 id="å‘å¸ƒï¼ˆreleaseï¼‰æ„å»º"><a href="#å‘å¸ƒï¼ˆreleaseï¼‰æ„å»º" class="headerlink" title="å‘å¸ƒï¼ˆreleaseï¼‰æ„å»º"></a>å‘å¸ƒï¼ˆreleaseï¼‰æ„å»º</h3><p>å½“é¡¹ç›®æœ€ç»ˆå‡†å¤‡å¥½å‘å¸ƒæ—¶ï¼Œå¯ä»¥ä½¿ç”¨ cargo build â€“release æ¥ä¼˜åŒ–ç¼–è¯‘é¡¹ç›®ã€‚è¿™ä¼šåœ¨ target/release è€Œä¸æ˜¯ target/debug ä¸‹ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ã€‚</p>]]></content>
      
      
        <tags>
            
            <tag> rust </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>centos7ç”¨æˆ·æœ€å¤§è¿›ç¨‹é™åˆ¶å¯¼è‡´çš„é—®é¢˜æ’æŸ¥</title>
      <link href="/2019/07/24/centos7%E7%94%A8%E6%88%B7%E6%9C%80%E5%A4%A7%E8%BF%9B%E7%A8%8B%E9%99%90%E5%88%B6%E5%AF%BC%E8%87%B4%E7%9A%84%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/"/>
      <url>/2019/07/24/centos7%E7%94%A8%E6%88%B7%E6%9C%80%E5%A4%A7%E8%BF%9B%E7%A8%8B%E9%99%90%E5%88%B6%E5%AF%BC%E8%87%B4%E7%9A%84%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5/</url>
      <content type="html"><![CDATA[<h3 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h3><blockquote><p>/etc/security/limits.d/90-nproc.conf ä¸ /etc/security/limits.conf éƒ½æ˜¯ç³»ç»Ÿç”¨æˆ·èµ„æºé…ç½®æ–‡ä»¶</p></blockquote><p>/etc/security/limits.conf é…ç½®æ–‡ä»¶å¯é™åˆ¶æ–‡ä»¶æ‰“å¼€æ•°ï¼Œç³»ç»Ÿè¿›ç¨‹ç­‰èµ„æºï¼Œåœ¨è¯¥æ–‡ä»¶é…ç½®ä¸­å†™çš„æœ€å¤§ç”¨æˆ·è¿›ç¨‹æ•°æ˜¯å—/etc/security/limits.d/90-nproc.confé…ç½®ä¸Šé™å½±å“çš„ã€‚</p><blockquote></blockquote><p>ä¸€èˆ¬ç³»ç»Ÿæ™®é€šç”¨æˆ·è¿›ç¨‹æ•°æ»¡äº†éƒ½æ˜¯ä¿®æ”¹/etc/security/limits.d/90-nproc.confæ–‡ä»¶ã€‚</p><h2 id="æ’æŸ¥è¿‡ç¨‹"><a href="#æ’æŸ¥è¿‡ç¨‹" class="headerlink" title="æ’æŸ¥è¿‡ç¨‹"></a>æ’æŸ¥è¿‡ç¨‹</h2><h3 id="æœåŠ¡å™¨æŠ¥é”™"><a href="#æœåŠ¡å™¨æŠ¥é”™" class="headerlink" title="æœåŠ¡å™¨æŠ¥é”™"></a>æœåŠ¡å™¨æŠ¥é”™</h3><blockquote><p> ErrorException: proc_open(): fork failed - Resource temporarily unavailable </p></blockquote><p>é¦–å…ˆæŸ¥çœ‹èµ„æºä½¿ç”¨æƒ…å†µ</p><ul><li><code>top</code>æŸ¥çœ‹æœåŠ¡å™¨èµ„æºå¤§æ¦‚ä½¿ç”¨æƒ…å†µï¼Œcpuã€å†…å­˜ æ­£å¸¸ã€‚</li><li><code>ps -ef|wc -l</code>è¿›ä¸€æ­¥æŸ¥çœ‹å½“å‰ç”¨æˆ·ä¸‹çš„è¿›ç¨‹æ•°é‡åœ¨<b>1024</b> å·¦å³</li></ul><p>åˆæ­¥åˆ¤æ–­æ˜¯ç”¨æˆ·æœ€å¤§è¿›ç¨‹æ•°é™åˆ¶</p><ul><li><code>ulimit -a</code> æŸ¥çœ‹ç”¨æˆ·æœ€å¤§è¿›ç¨‹é…ç½® æ˜¯ 31207</li></ul><blockquote><p>max user processes              (-u) 31207</p></blockquote><p>å¾ˆè¿·æƒ‘ ï¼ï¼Ÿï¼Ÿæ˜æ˜æ•°é‡æ²¡é™åˆ¶ä¸ºä»€ä¹ˆè¿›ç¨‹ä¸€ç›´åœ¨1024å·¦å³ã€‚</p><ul><li>google æŸ¥è¯¢ç›¸å…³é—®é¢˜</li></ul><p>æœ€ç»ˆå‘ç° </p><blockquote><p>/etc/security/limits.conf é…ç½®æ–‡ä»¶å¯é™åˆ¶æ–‡ä»¶æ‰“å¼€æ•°ï¼Œç³»ç»Ÿè¿›ç¨‹ç­‰èµ„æºï¼Œåœ¨è¯¥æ–‡ä»¶é…ç½®ä¸­å†™çš„æœ€å¤§ç”¨æˆ·è¿›ç¨‹æ•°æ˜¯å—/etc/security/limits.d/90-nproc.confé…ç½®ä¸Šé™å½±å“çš„ã€‚</p></blockquote><p>ä¿®æ”¹<code>/etc/security/limits.d/90-nproc.conf</code>æ–‡ä»¶ä¸º</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*          soft    nproc     10240</span><br><span class="line">root       soft    nproc     unlimited</span><br></pre></td></tr></table></figure><p><b>è§£å†³é—®é¢˜</b></p>]]></content>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> æœ€å¤§è¿›ç¨‹ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>centos7å®‰è£…php7.3.6è®°å½•</title>
      <link href="/2019/07/02/centos7%E5%AE%89%E8%A3%85php7-3-6%E8%AE%B0%E5%BD%95/"/>
      <url>/2019/07/02/centos7%E5%AE%89%E8%A3%85php7-3-6%E8%AE%B0%E5%BD%95/</url>
      <content type="html"><![CDATA[<p>./configure  â€“prefix=/opt/software/php-7.3.6 â€“sysconfdir=/opt/software/php-7.3.6/etc â€“with-config-file-scan-dir=/opt/software/php-7.3.6/etc/ini â€“enable-fpm â€“with-fpm-user= â€“with-fpm-group= â€“enable-mysqlnd â€“with-mysqli=mysqlnd â€“with-pdo-mysql=mysqlnd â€“enable-mysqlnd-compression-support â€“with-iconv-dir â€“with-freetype-dir â€“with-jpeg-dir â€“with-png-dir â€“with-zlib â€“with-zlib-dir â€“enable-libxml â€“with-libxml-dir â€“enable-xml â€“disable-rpath â€“enable-bcmath â€“enable-shmop â€“enable-sysvsem â€“enable-inline-optimization â€“with-curl â€“enable-mbregex â€“enable-mbstring â€“enable-intl â€“enable-ftp â€“with-gd â€“enable-gd-jis-conv â€“with-openssl â€“with-mhash â€“enable-pcntl â€“enable-sockets â€“with-xmlrpc â€“enable-zip â€“enable-soap â€“with-gettext â€“disable-fileinfo â€“enable-opcache=no â€“with-pear â€“enable-maintainer-zts â€“with-ldap=shared â€“enable-pdo â€“enable-sysvshm â€“with-xpm-dir â€“enable-session â€“enable-ctype â€“without-gdbm</p><h3 id="æŠ¥é”™"><a href="#æŠ¥é”™" class="headerlink" title="æŠ¥é”™"></a>æŠ¥é”™</h3><blockquote><p>configure: error: Please reinstall the libzip distribution</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#ä¸‹è½½ç¼–è¯‘å®‰è£…</span><br><span class="line">wget https://nih.at/libzip/libzip-1.2.0.tar.gz</span><br><span class="line">tar -zxvf libzip-1.2.0.tar.gz</span><br><span class="line">cd libzip-1.2.0</span><br><span class="line">./configure</span><br><span class="line">make &amp;&amp; make install</span><br></pre></td></tr></table></figure><h3 id="æŠ¥é”™-1"><a href="#æŠ¥é”™-1" class="headerlink" title="æŠ¥é”™"></a>æŠ¥é”™</h3><p>configure: error: off_t undefined; check your library configuration</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#æ·»åŠ æœç´¢è·¯å¾„åˆ°é…ç½®æ–‡ä»¶</span><br><span class="line">echo &apos;/usr/local/lib64</span><br><span class="line">/usr/local/lib</span><br><span class="line">/usr/lib</span><br><span class="line">/usr/lib64&apos;&gt;&gt;/etc/ld.so.conf</span><br><span class="line"></span><br><span class="line">#ç„¶å æ›´æ–°é…ç½®</span><br><span class="line">ldconfig -v</span><br></pre></td></tr></table></figure><h3 id="make-ext-zip-php-zip-lo-é”™è¯¯-1"><a href="#make-ext-zip-php-zip-lo-é”™è¯¯-1" class="headerlink" title="make: *** [ext/zip/php_zip.lo] é”™è¯¯ 1"></a>make: *** [ext/zip/php_zip.lo] é”™è¯¯ 1</h3><p>cp /usr/local/lib/libzip/include/zipconf.h /usr/local/include/zipconf.h</p><h2 id="æ·»åŠ é…ç½®æ–‡ä»¶"><a href="#æ·»åŠ é…ç½®æ–‡ä»¶" class="headerlink" title="æ·»åŠ é…ç½®æ–‡ä»¶"></a>æ·»åŠ é…ç½®æ–‡ä»¶</h2><p>cp php-fpm.conf.default php-fpm.conf<br>sudo cp ~/php-7.3.6/php.ini-production ./lib/php.ini</p><h3 id="æ‰©å±•ç›®å½•"><a href="#æ‰©å±•ç›®å½•" class="headerlink" title="æ‰©å±•ç›®å½•"></a>æ‰©å±•ç›®å½•</h3><p>/opt/software/php-7.3.6/lib/php/extensions/no-debug-zts-20180731/</p>]]></content>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>laravel-excelä½¿ç”¨è®°å½•</title>
      <link href="/2019/06/18/laravel-excel%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/"/>
      <url>/2019/06/18/laravel-excel%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95/</url>
      <content type="html"><![CDATA[<h2 id="éœ€è¦æ³¨æ„çš„ç‚¹"><a href="#éœ€è¦æ³¨æ„çš„ç‚¹" class="headerlink" title="éœ€è¦æ³¨æ„çš„ç‚¹"></a>éœ€è¦æ³¨æ„çš„ç‚¹</h2><p>ps: è§£å†³è¿‡çš„é—®é¢˜è®°å½•ä¸‹æ¥ï¼Œä¸èƒ½ç›¸ä¿¡è‡ªå·±è„‘å­çš„è®°å¿†åŠ›ï¼Œå¾ˆå¿«å°±ä¼šå¿˜è®° ğŸ˜†</p><p>è§£å†³excelæ ‡é¢˜ä¸ºæ±‰å­—æ—¶ï¼Œè§£ææœ‰é—®é¢˜ï¼›å°†<code>to_ascii</code>è®¾ç½®ä¸º<code>false</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/*</span><br><span class="line">        |--------------------------------------------------------------------------</span><br><span class="line">        | Sheet heading conversion</span><br><span class="line">        |--------------------------------------------------------------------------</span><br><span class="line">        |</span><br><span class="line">        | Convert headings to ASCII å°†æ ‡é¢˜è½¬æ¢ä¸ºASCII</span><br><span class="line">        | Note: only applies to &apos;heading&apos; settings &apos;true&apos; &amp;&amp; &apos;slugged&apos;</span><br><span class="line">        |</span><br><span class="line">        */</span><br><span class="line"></span><br><span class="line">        &apos;to_ascii&apos;                =&gt; false,</span><br></pre></td></tr></table></figure>]]></content>
      
      
        <tags>
            
            <tag> laravel </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>è®°ä¸€æ¬¡file_get_contentsæŠ¥é”™</title>
      <link href="/2019/05/16/%E8%AE%B0%E4%B8%80%E6%AC%A1file-get-contents%E6%8A%A5%E9%94%99/"/>
      <url>/2019/05/16/%E8%AE%B0%E4%B8%80%E6%AC%A1file-get-contents%E6%8A%A5%E9%94%99/</url>
      <content type="html"><![CDATA[<h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>phpæœåŠ¡å™¨æŠ¥é”™ï¼š</p><p>ErrorException: file_get_contents(): SSL operation failed with code 1. OpenSSL Error messages:<br>error:14090086:SSL routines:SSL3_GET_SERVER_CERTIFICATE:certificate verify failed</p><h2 id="æ’æŸ¥"><a href="#æ’æŸ¥" class="headerlink" title="æ’æŸ¥"></a>æ’æŸ¥</h2><p>æŸ¥çœ‹<code>file_get_contents</code>å‡½æ•°æ–‡æ¡£å‘ç°è­¦å‘Šâš ï¸</p><blockquote><p>Warning<br>ä½¿ç”¨ SSL æ—¶ï¼ŒMicrosoft IIS ä¼šè¿ååè®®ä¸å‘é€close_notifyæ ‡è®°å°±å…³é—­è¿æ¥ã€‚PHP ä¼šåœ¨åˆ°è¾¾æ•°æ®å°¾ç«¯æ—¶æŠ¥å‘Šâ€œSSL: Fatal Protocol Errorâ€ã€‚ è¦è§£å†³æ­¤é—®é¢˜ï¼Œerror_reporting åº”è®¾å®šä¸ºé™ä½çº§åˆ«è‡³ä¸åŒ…å«è­¦å‘Šã€‚ PHP 4.3.7 åŠæ›´é«˜ç‰ˆæœ¬å¯ä»¥åœ¨ä½¿ç”¨ https:// åŒ…è£…å™¨æ‰“å¼€æµæ—¶æ£€æµ‹å‡ºæœ‰é—®é¢˜çš„ IIS æœåŠ¡å™¨è½¯ä»¶ å¹¶æŠ‘åˆ¶è­¦å‘Šã€‚åœ¨ä½¿ç”¨ fsockopen() åˆ›å»º ssl:// å¥—æ¥å­—æ—¶, å¼€å‘è€…éœ€æ£€æµ‹å¹¶æŠ‘åˆ¶æ­¤è­¦å‘Šã€‚</p></blockquote><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>æ ¹æ®æ–‡æ¡£è¯´æ˜æ·»åŠ </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(E_ERROR | E_PARSE);</span><br><span class="line">$filePath = file_get_contents($image);</span><br></pre></td></tr></table></figure>]]></content>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> Microsoft IIS </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>webæœåŠ¡ä¸­è·å–å®¢æˆ·ç«¯ip</title>
      <link href="/2019/05/15/web%E6%9C%8D%E5%8A%A1%E4%B8%AD%E8%8E%B7%E5%8F%96%E5%AE%A2%E6%88%B7%E7%AB%AFip/"/>
      <url>/2019/05/15/web%E6%9C%8D%E5%8A%A1%E4%B8%AD%E8%8E%B7%E5%8F%96%E5%AE%A2%E6%88%B7%E7%AB%AFip/</url>
      <content type="html"><![CDATA[<h2 id="X-Forwarded-For"><a href="#X-Forwarded-For" class="headerlink" title="X-Forwarded-For"></a>X-Forwarded-For</h2><blockquote><p>X-Forwarded-Forï¼ˆXFFï¼‰æ˜¯ç”¨æ¥è¯†åˆ«é€šè¿‡HTTPä»£ç†æˆ–è´Ÿè½½å‡è¡¡æ–¹å¼è¿æ¥åˆ°WebæœåŠ¡å™¨çš„å®¢æˆ·ç«¯æœ€åŸå§‹çš„IPåœ°å€çš„HTTPè¯·æ±‚å¤´å­—æ®µã€‚ Squid ç¼“å­˜ä»£ç†æœåŠ¡å™¨çš„å¼€å‘äººå‘˜æœ€æ—©å¼•å…¥äº†è¿™ä¸€HTTPå¤´å­—æ®µï¼Œå¹¶ç”±IETFåœ¨HTTPå¤´å­—æ®µæ ‡å‡†åŒ–è‰æ¡ˆä¸­æ­£å¼æå‡ºã€‚</p></blockquote><h3 id="ç›¸å…³-remote-addr"><a href="#ç›¸å…³-remote-addr" class="headerlink" title="ç›¸å…³ $remote_addr"></a>ç›¸å…³ $remote_addr</h3><blockquote><p>æ˜¯nginxä¸å®¢æˆ·ç«¯è¿›è¡ŒTCPè¿æ¥è¿‡ç¨‹ä¸­ï¼Œè·å¾—çš„å®¢æˆ·ç«¯çœŸå®åœ°å€. Remote Address æ— æ³•ä¼ªé€ ï¼Œå› ä¸ºå»ºç«‹ TCP è¿æ¥éœ€è¦ä¸‰æ¬¡æ¡æ‰‹ï¼Œå¦‚æœä¼ªé€ äº†æº IPï¼Œæ— æ³•å»ºç«‹ TCP è¿æ¥ï¼Œæ›´ä¸ä¼šæœ‰åé¢çš„ HTTP è¯·æ±‚</p></blockquote><h2 id="æ ¼å¼"><a href="#æ ¼å¼" class="headerlink" title="æ ¼å¼"></a>æ ¼å¼</h2><blockquote><p>è¿™ä¸€HTTPå¤´ä¸€èˆ¬æ ¼å¼å¦‚ä¸‹:</p></blockquote><p>X-Forwarded-For: client1, proxy1, proxy2, proxy3</p><blockquote><p>å…¶ä¸­çš„å€¼é€šè¿‡ä¸€ä¸ª é€—å·+ç©ºæ ¼ æŠŠå¤šä¸ªIPåœ°å€åŒºåˆ†å¼€, æœ€å·¦è¾¹(client1)æ˜¯æœ€åŸå§‹å®¢æˆ·ç«¯çš„IPåœ°å€, ä»£ç†æœåŠ¡å™¨æ¯æˆåŠŸæ”¶åˆ°ä¸€ä¸ªè¯·æ±‚ï¼Œå°±æŠŠè¯·æ±‚æ¥æºIPåœ°å€ã€remote_addrã€‘æ·»åŠ åˆ°å³è¾¹ã€‚ åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œè¿™ä¸ªè¯·æ±‚æˆåŠŸé€šè¿‡äº†ä¸‰å°ä»£ç†æœåŠ¡å™¨ï¼šproxy1, proxy2 åŠ proxy3ã€‚è¯·æ±‚ç”±client1å‘å‡ºï¼Œåˆ°è¾¾äº†proxy3(proxy3å¯èƒ½æ˜¯è¯·æ±‚çš„ç»ˆç‚¹)ã€‚è¯·æ±‚åˆšä»client1ä¸­å‘å‡ºæ—¶ï¼ŒXFFæ˜¯ç©ºçš„ï¼Œè¯·æ±‚è¢«å‘å¾€proxy1ï¼›é€šè¿‡proxy1çš„æ—¶å€™ï¼Œclient1è¢«æ·»åŠ åˆ°XFFä¸­ï¼Œä¹‹åè¯·æ±‚è¢«å‘å¾€proxy2;é€šè¿‡proxy2çš„æ—¶å€™ï¼Œproxy1è¢«æ·»åŠ åˆ°XFFä¸­ï¼Œä¹‹åè¯·æ±‚è¢«å‘å¾€proxy3ï¼›é€šè¿‡proxy3æ—¶ï¼Œproxy2è¢«æ·»åŠ åˆ°XFFä¸­ï¼Œä¹‹åè¯·æ±‚çš„çš„å»å‘ä¸æ˜ï¼Œå¦‚æœproxy3ä¸æ˜¯è¯·æ±‚ç»ˆç‚¹ï¼Œè¯·æ±‚ä¼šè¢«ç»§ç»­è½¬å‘ã€‚</p></blockquote><p>é‰´äºä¼ªé€ è¿™ä¸€å­—æ®µéå¸¸å®¹æ˜“ï¼Œåº”è¯¥è°¨æ…ä½¿ç”¨X-Forwarded-Forå­—æ®µã€‚æ­£å¸¸æƒ…å†µä¸‹XFFä¸­æœ€åä¸€ä¸ªIPåœ°å€æ˜¯æœ€åä¸€ä¸ªä»£ç†æœåŠ¡å™¨çš„IPåœ°å€, è¿™é€šå¸¸æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¯é çš„ä¿¡æ¯æ¥æº</p><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>1.ä½¿ç”¨nginxè¿›è¡Œåå‘ä»£ç†çš„æ—¶å€™è®¾ç½®</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span><br></pre></td></tr></table></figure><p>è¿™æ ·ngixnä¼šå°†è¯·æ±‚æ¥æºIP<code>remote_addr</code>è¿½åŠ åˆ°<code>X-Forwarded-For</code>å¹¶ç”¨ï¼ˆ, + ç©ºæ ¼ï¼‰éš”å¼€ ã€‚è¯·æ±‚headerä¸­ä¸å­˜åœ¨X-Forwarded-For    åˆ™æ˜¯<code>remote_addr</code></p><p>2.åœ¨æœ€å‰ç«¯çš„è½¬å‘ä»£ç†æœåŠ¡å™¨ä¸­è®¾ç½®X-Forwarded-For,åç«¯æœåŠ¡å™¨ç¨‹åºä»ä¸­è·å–å®¢æˆ·ç«¯IPæ—¶,<strong>ä»åå‘å‰ï¼ˆé˜²æ­¢ä¼ªé€ ä»£ç†çš„IPï¼‰</strong>å–X-Forwarded-Forä¸­æœ€å‰ç«¯ä»£ç†IPä¹‹å‰ä¸€ä¸ªIPå°±æ˜¯å®¢æˆ·ç«¯çš„IPï¼ˆå’Œæœ€å‰ç«¯ä»£ç†è¿›è¡Œtcpè¿æ¥çš„çœŸå®IPï¼‰ã€å¦‚æœä½¿ç”¨äº†cdnï¼Œcdnçš„IPå°±æ˜¯æœ€å‰ç«¯IPã€‘ã€å¦‚æœæ²¡æœ‰ä½¿ç”¨ä»£ç†æœåŠ¡å™¨è½¬å‘ï¼Œç›´æ¥ä½¿ç”¨<code>remote_addr</code>å°±å¯ä»¥ã€‘</p><h2 id="nginx-proxy-passå’Œfastcgi-pass-çš„åŒºåˆ«"><a href="#nginx-proxy-passå’Œfastcgi-pass-çš„åŒºåˆ«" class="headerlink" title="nginx proxy_passå’Œfastcgi_pass çš„åŒºåˆ«"></a>nginx proxy_passå’Œfastcgi_pass çš„åŒºåˆ«</h2><p>proxy_passæ˜¯åå‘ä»£ç†æ¨¡å—ã€‚</p><p>fastcgi_passæ˜¯è½¬å‘ç»™ factcgi åç«¯å¤„ç†ã€‚è¿™ç§æ–¹å¼nginxåªæ˜¯webæœåŠ¡å™¨ï¼Œåº”ç”¨ç¨‹åºè·å–çš„<code>remote_addr</code>IPï¼Œå°±æ˜¯è¯·æ±‚åˆ°nginxçš„çœŸå®IP</p><blockquote><p>FastCGIå…¨ç§° å¿«é€Ÿé€šç”¨ç½‘å…³æ¥å£ï¼ˆFastCommonGatewayInterfaceï¼‰ã€‚</p><p>FastCGIåƒæ˜¯ä¸€ä¸ªå¸¸é©»(long-live)å‹çš„CGIï¼Œå®ƒå¯ä»¥ä¸€ç›´æ‰§è¡Œç€ï¼Œåªè¦æ¿€æ´»åï¼Œä¸ä¼šæ¯æ¬¡éƒ½è¦èŠ±è´¹æ—¶é—´å»forkä¸€æ¬¡(è¿™æ˜¯CGIæœ€ä¸ºäººè¯Ÿç—…çš„fork-and-execute æ¨¡å¼)ã€‚å®ƒè¿˜æ”¯æŒåˆ†å¸ƒå¼çš„è¿ç®—, å³ FastCGI ç¨‹åºå¯ä»¥åœ¨ç½‘ç«™æœåŠ¡å™¨ä»¥å¤–çš„ä¸»æœºä¸Šæ‰§è¡Œå¹¶ä¸”æ¥å—æ¥è‡ªå…¶å®ƒç½‘ç«™æœåŠ¡å™¨æ¥çš„è¯·æ±‚ã€‚</p></blockquote><p>FastCGIæ˜¯è¯­è¨€æ— å…³çš„ã€å¯ä¼¸ç¼©æ¶æ„çš„CGIå¼€æ”¾æ‰©å±•ï¼Œå…¶ä¸»è¦è¡Œä¸ºæ˜¯å°†CGIè§£é‡Šå™¨è¿›ç¨‹ä¿æŒåœ¨å†…å­˜ä¸­å¹¶å› æ­¤è·å¾—è¾ƒé«˜çš„æ€§èƒ½ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼ŒCGIè§£é‡Šå™¨çš„åå¤åŠ è½½æ˜¯CGIæ€§èƒ½ä½ä¸‹çš„ä¸»è¦åŸå› ï¼Œå¦‚æœCGIè§£é‡Šå™¨ä¿æŒåœ¨å†…å­˜ä¸­å¹¶æ¥å—FastCGIè¿›ç¨‹ç®¡ç†å™¨è°ƒåº¦ï¼Œåˆ™å¯ä»¥æä¾›è‰¯å¥½çš„æ€§èƒ½ã€ä¼¸ç¼©æ€§ã€Fail- Overç‰¹æ€§ç­‰ç­‰ã€‚</p><p>php-fmp å°±æ˜¯FastCGIçš„å®ç°ã€‚</p>]]></content>
      
      
        <tags>
            
            <tag> ngixn </tag>
            
            <tag> http </tag>
            
            <tag> xff </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>mysqlä¸­randå‡½æ•°ä½¿ç”¨</title>
      <link href="/2019/04/23/mysql%E4%B8%ADrand%E5%87%BD%E6%95%B0%E4%BD%BF%E7%94%A8/"/>
      <url>/2019/04/23/mysql%E4%B8%ADrand%E5%87%BD%E6%95%B0%E4%BD%BF%E7%94%A8/</url>
      <content type="html"><![CDATA[<p>éœ€æ±‚æ˜¯ï¼šä»æ•°æ®åº“ä¸­éšæœºå–å‡ºç¬¦åˆæ¡ä»¶çš„å‡ æ¡æ•°æ®;</p><p>å¯ä½¿ç”¨ä¸‹é¢æ¥éšæœºè·å–5æ¡æ•°æ®</p><p><code>select * from table order by rand() limit 5</code> </p><p>éœ€è¦æ³¨æ„ï¼š è¿™ç§æ–¹å¼åªé€‚åˆæœ¬èº«æ•°æ®æ¯”è¾ƒå°‘æˆ–è€…é€šè¿‡whereæ¡ä»¶ç¬¦çº¦æŸåæ•°æ®é‡å¾ˆå°‘çš„æƒ…å†µä¸‹ä½¿ç”¨ï¼Œå› ä¸º<code>order by rand()</code>ä¼šæ•´ä½“æ’åºï¼Œæ•°æ®é‡æ¯”è¾ƒå¤§çš„æ—¶å€™é€Ÿåº¦å¾ˆæ…¢ã€‚</p><blockquote><p>ç»æµ‹è¯•åœ¨50Wæ¡æ•°æ®ä¸­éšæœºå–éœ€è¦åå‡ ç§’çš„æ—¶é—´ã€‚</p></blockquote>]]></content>
      
      
        <tags>
            
            <tag> mysql </tag>
            
            <tag> rand() </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>elkæ—¥å¿—ç›‘æ§æ­å»º</title>
      <link href="/2019/02/20/elk%E6%97%A5%E5%BF%97%E7%9B%91%E6%8E%A7%E6%90%AD%E5%BB%BA/"/>
      <url>/2019/02/20/elk%E6%97%A5%E5%BF%97%E7%9B%91%E6%8E%A7%E6%90%AD%E5%BB%BA/</url>
      <content type="html"><![CDATA[<h1 id="elkæ—¥å¿—ç›‘æ§æ­å»º"><a href="#elkæ—¥å¿—ç›‘æ§æ­å»º" class="headerlink" title="elkæ—¥å¿—ç›‘æ§æ­å»º"></a>elkæ—¥å¿—ç›‘æ§æ­å»º</h1><blockquote><p>centos7ç³»ç»Ÿ</p></blockquote><h2 id="1-æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å·²å®‰è£…javaç¯å¢ƒï¼šjava-version"><a href="#1-æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å·²å®‰è£…javaç¯å¢ƒï¼šjava-version" class="headerlink" title="1. æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å·²å®‰è£…javaç¯å¢ƒï¼šjava -version"></a>1. æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å·²å®‰è£…javaç¯å¢ƒï¼š<code>java -version</code></h2><h2 id="2-elkå®˜ç½‘ä¸‹è½½è§£å‹"><a href="#2-elkå®˜ç½‘ä¸‹è½½è§£å‹" class="headerlink" title="2. elkå®˜ç½‘ä¸‹è½½è§£å‹"></a>2. <a href="https://www.elastic.co" target="_blank" rel="noopener">elkå®˜ç½‘</a>ä¸‹è½½è§£å‹</h2><h2 id="é…ç½®å¯åŠ¨"><a href="#é…ç½®å¯åŠ¨" class="headerlink" title="é…ç½®å¯åŠ¨"></a>é…ç½®å¯åŠ¨</h2><ol><li>ä½¿ç”¨é»˜è®¤é…ç½®å¯åŠ¨es <code>./bin/elasticsearch &amp;</code> æµ‹è¯•æ˜¯å¦å¯åŠ¨æˆåŠŸ <code>curl &#39;http://localhost:9200/?pretty&#39;</code></li><li>é…ç½® logstashï¼Œåœ¨configç›®å½•ä¸‹ç©¿ä»¶conf.dæ–‡ä»¶å¤¹ç”¨æ¥å­˜æ”¾é…ç½®æ–‡ä»¶ï¼Œå¯åŠ¨ <code>./bin/logstash --path.settings ./config/ -f ./config/conf.d &amp;</code></li><li>é…ç½® filebeat ç›®å½•ä¸‹çš„filebeat.ymlæ–‡ä»¶ï¼Œå¯åŠ¨<code>nohup ./filebeat -e -c filebeat.yml &gt;/dev/null 2&gt;&amp;1 &amp;</code></li><li>kibana å¯åŠ¨<code>./bin/kibana &amp;</code></li><li>ä½¿ç”¨nginxå¯¹kibanaåå‘ä»£ç†ã€æ·»åŠ ç™»å½•é™åˆ¶ã€‚</li></ol><h2 id="ç›‘æ§æŠ¥è­¦-kibanaæ’ä»¶sentinl"><a href="#ç›‘æ§æŠ¥è­¦-kibanaæ’ä»¶sentinl" class="headerlink" title="ç›‘æ§æŠ¥è­¦ kibanaæ’ä»¶sentinl"></a>ç›‘æ§æŠ¥è­¦ kibanaæ’ä»¶sentinl</h2><p>ç°åœ¨å¯¹åº”çš„sentinlç‰ˆæœ¬<br>æŒ‡å®šæ–‡ä»¶è·¯å¾„å®‰è£… <code>./kibana-plugin install file:///sentinl-v6.2.4.zip</code></p><h2 id="kibana-é…ç½®nginxæˆæƒç™»å½•"><a href="#kibana-é…ç½®nginxæˆæƒç™»å½•" class="headerlink" title="kibana é…ç½®nginxæˆæƒç™»å½•"></a>kibana é…ç½®nginxæˆæƒç™»å½•</h2><ul><li>å®‰è£…å¯†ç ç”Ÿäº§å·¥å…· <code>yum install httpd-tools</code></li><li>ç”Ÿæˆå¯†ç æ–‡ä»¶ <code>sudo htpasswd -bc /opt/nginx/conf/htpasswd.kibana admin admin</code></li><li>é…ç½®nginx </li><li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"> server &#123;</span><br><span class="line">   listen 5602;</span><br><span class="line">   server_name youname;       #ä¸»æœºå</span><br><span class="line"></span><br><span class="line">   location / &#123;</span><br><span class="line">       proxy_pass http://localhost:5601;</span><br><span class="line">       auth_basic &quot;Basic Authentication&quot;;</span><br><span class="line">       auth_basic_user_file &quot;/path/htpasswd.kibana&quot;; #å¯†ç æ–‡ä»¶ä½ç½®</span><br><span class="line">       proxy_http_version 1.1;</span><br><span class="line">       proxy_set_header Upgrade $http_upgrade;</span><br><span class="line">       proxy_set_header Connection &apos;upgrade&apos;;</span><br><span class="line">       proxy_set_header Host $host;</span><br><span class="line">       proxy_cache_bypass $http_upgrade;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>é‡å¯nginx</p></li></ul>]]></content>
      
      
        <tags>
            
            <tag> linux </tag>
            
            <tag> elk </tag>
            
            <tag> sentinl </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Supervisorä½¿ç”¨ç¬”è®°</title>
      <link href="/2018/12/12/Supervisor%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/"/>
      <url>/2018/12/12/Supervisor%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/</url>
      <content type="html"><![CDATA[<h1 id="Supervisorä½¿ç”¨ç¬”è®°"><a href="#Supervisorä½¿ç”¨ç¬”è®°" class="headerlink" title="Supervisorä½¿ç”¨ç¬”è®°"></a>Supervisorä½¿ç”¨ç¬”è®°</h1><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p> centosç³»ç»Ÿï¼Œä½¿ç”¨rootè´¦æˆ·</p><ul><li>å®‰è£… </li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install supervisor</span><br></pre></td></tr></table></figure><ul><li>ç”Ÿæˆé…ç½®æ–‡ä»¶</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo_supervisord_conf &gt; /etc/supervisord.conf</span><br></pre></td></tr></table></figure><ul><li>åˆ›å»ºç›®å½•, å¹¶å¼•å…¥ç›®å½•é…ç½®</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir -p /etc/supervisor/conf.d</span><br></pre></td></tr></table></figure><ul><li>ç¼–è¾‘/etc/supervisord.conf, ä¿®æ”¹æ–‡ä»¶æœ«å°¾çš„[include]ä¸‹çš„fileså­—æ®µ</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[include]</span><br><span class="line">files = /etc/supervisor/conf.d/*.conf</span><br></pre></td></tr></table></figure><h1 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h1><ul><li>é…ç½®éœ€è¦ç›‘å¬çš„é˜Ÿåˆ—, åˆ›å»ºé…ç½®æ–‡ä»¶/etc/supervisor/conf.d/queue.conf</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[program:laravel-d3ingo] ;åç§°</span><br><span class="line">process_name=%(program_name)s_%(process_num)02d   ;è‡ªå®šä¹‰å¤šè¿›ç¨‹åç§°</span><br><span class="line">command=php /opt/project/d3ingo-tool/artisan queue:work --queue=d3ingo --sleep=3 --tries=3 ;å¯åŠ¨å‘½ä»¤</span><br><span class="line">autostart=true   ;è‡ªåŠ¨å¼€å¯</span><br><span class="line">autorestart=true ;è‡ªåŠ¨é‡å¯</span><br><span class="line">user=root        </span><br><span class="line">numprocs=2      ;è¿›ç¨‹æ•°é‡</span><br><span class="line">redirect_stderr=true</span><br><span class="line">stdout_logfile=/etc/supervisor/logs/d3ingo.log  ;æ—¥å¿—è·¯å¾„ï¼ˆå¿…é¡»æå‰åˆ›å»ºå¥½ï¼Œä¸ä¼šè‡ªåŠ¨åˆ›å»ºï¼‰</span><br></pre></td></tr></table></figure><h1 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">supervisord -c /etc/supervisord.conf</span><br><span class="line">supervisorctl</span><br></pre></td></tr></table></figure><p>è¿›å…¥supervisorctlæ§åˆ¶å° <code>start all</code></p>]]></content>
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Supervisor </tag>
            
            <tag> laravel </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>libreofficeæŠŠæ–‡æ¡£è½¬æ¢æˆPDF</title>
      <link href="/2018/11/14/libreoffice%E6%8A%8A%E6%96%87%E6%A1%A3%E8%BD%AC%E6%8D%A2%E6%88%90PDF/"/>
      <url>/2018/11/14/libreoffice%E6%8A%8A%E6%96%87%E6%A1%A3%E8%BD%AC%E6%8D%A2%E6%88%90PDF/</url>
      <content type="html"><![CDATA[<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install libreoffice</span><br><span class="line">yum install libreoffice-headless</span><br></pre></td></tr></table></figure><h3 id="php-fpm-è°ƒç”¨"><a href="#php-fpm-è°ƒç”¨" class="headerlink" title="php-fpm è°ƒç”¨"></a>php-fpm è°ƒç”¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// $path ç›®æ ‡è·¯å¾„ã€name_fix æºæ–‡ä»¶è·¯å¾„</span><br><span class="line"> $shell_str = &quot;export HOME=/tmp/ &amp;&amp; /usr/bin/libreoffice  --invisible --convert-to pdf --outdir $path $name_fix&quot;;</span><br><span class="line"> $result_str = exec($shell_str, $output, $return_var);</span><br></pre></td></tr></table></figure><h3 id="å¯èƒ½å‡ºç°è½¬PDFä¹‹å-ä¸­æ–‡å‡ºç°ç¼–ç¨‹å°æ–¹æ¡†"><a href="#å¯èƒ½å‡ºç°è½¬PDFä¹‹å-ä¸­æ–‡å‡ºç°ç¼–ç¨‹å°æ–¹æ¡†" class="headerlink" title="å¯èƒ½å‡ºç°è½¬PDFä¹‹å ä¸­æ–‡å‡ºç°ç¼–ç¨‹å°æ–¹æ¡†"></a>å¯èƒ½å‡ºç°è½¬PDFä¹‹å ä¸­æ–‡å‡ºç°ç¼–ç¨‹å°æ–¹æ¡†</h3><p>æ‹·è´ä¸­æ–‡å¸¸ç”¨å­—ä½“æ”¾å…¥ linuxç³»ç»Ÿå­—ä½“ä¸­</p>]]></content>
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> linux </tag>
            
            <tag> libreoffice </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>go åç¨‹æ± å®ç°</title>
      <link href="/2018/04/02/go-e5-8d-8f-e7-a8-8b-e6-b1-a0-e5-ae-9e-e7-8e-b0/"/>
      <url>/2018/04/02/go-e5-8d-8f-e7-a8-8b-e6-b1-a0-e5-ae-9e-e7-8e-b0/</url>
      <content type="html"><![CDATA[<h1 id="å…·ä½“å®ç°ä»£ç "><a href="#å…·ä½“å®ç°ä»£ç " class="headerlink" title="å…·ä½“å®ç°ä»£ç "></a>å…·ä½“å®ç°ä»£ç </h1><pre><code>package workimport &quot;sync&quot;// åç¨‹å·¥ä½œæ± æ¥å£ï¼Œä½¿ç”¨å·¥ä½œæ± çš„workå¿…é¡»å®ç°è¯¥æ¥å£type Worker interface {    Task()}// å·¥ä½œæ± ç»“æ„ï¼Œworkä¸ºæ— ç¼“å­˜ç®¡é“ï¼Œwgæ§åˆ¶çº¤ç¨‹æ‰§è¡Œå®Œæˆtype Pool struct {    work chan Worker    wg   sync.WaitGroup}// åˆ›å»ºä¸€ä¸ªæŒ‡å®šçº¤ç¨‹çš„workeræ± func New(maxGoroutines int) *Pool {    p := &amp;amp;Pool{        work: make(chan Worker), // åˆå§‹åŒ–æ— ç¼“å­˜é€šé“ï¼Œç”¨æ¥å­˜å‚¨work    }    p.wg.Add(maxGoroutines)    for i := 0; i &amp;lt; maxGoroutines; i++ {        go func() {            for w := range p.work { // ä½¿ç”¨rangeä»é€šé“ä¸­å–workï¼Œå½“é€šé“ä¸­æ²¡æœ‰å€¼æ—¶å µå¡ï¼Œé€šé“å…³é—­æ—¶å¾ªç¯ç»“æŸ                w.Task()            }            p.wg.Done()        }()    }    return p}// è¿è¡Œä¸€ä¸ªworkerfunc (p *Pool) Run(w Worker) {    p.work &amp;lt;- w // å‘é€šé“ä¸­å†™å…¥worker,å¦‚æœ‰ç©ºé—²çº¤ç¨‹å°†è¿è¡Œï¼Œå¦‚æš‚æ— ç©ºé—²çº¤ç¨‹å°†å µå¡}// å…³é—­workeræ± func (p *Pool) Shutdown() {    close(p.work) // å…³é—­é€šé“ï¼Œå„çº¤ç¨‹æ‰§è¡Œå®Œå½“å‰ä»»åŠ¡å„è‡ªé€€å‡º    p.wg.Wait()   // ç­‰å¾…æ‰€æœ‰çº¤ç¨‹è¿è¡Œå®Œæ¯•}</code></pre>]]></content>
      
      <categories>
          
          <category> go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>go poolèµ„æºæ± </title>
      <link href="/2018/03/25/go-pool-e8-b5-84-e6-ba-90-e6-b1-a0/"/>
      <url>/2018/03/25/go-pool-e8-b5-84-e6-ba-90-e6-b1-a0/</url>
      <content type="html"><![CDATA[<h1 id="èµ„æºæ± å®ç°"><a href="#èµ„æºæ± å®ç°" class="headerlink" title="èµ„æºæ± å®ç°"></a>èµ„æºæ± å®ç°</h1><pre><code>package poolimport (    &quot;sync&quot;    &quot;io&quot;    &quot;errors&quot;    &quot;log&quot;)type Pool struct {    m         sync.Mutex    resources chan io.Closer    factory   func() (io.Closer, error)    closed    bool}// èµ„æºæ± å·²å…³é—­é”™è¯¯æç¤ºvar ErrPoolClosed = errors.New(&quot;pool has been closed&quot;)func New(fn func() (io.Closer, error), size uint) (*Pool, error) {    if size &amp;lt;= 0 {        return nil, errors.New(&quot;pool size too small&quot;)    }    return &amp;amp;Pool{        resources: make(chan io.Closer, size),        factory:   fn,    }, nil}// è·å–ä¸€ä¸ªèµ„æºfunc (p *Pool) Acquire() (resource io.Closer, err error) {    select {    case r, ok := &amp;lt;-p.resources:        log.Println(&quot;Acquire:&quot;, &quot;shared resource&quot;)        if !ok {            return nil, ErrPoolClosed        }        return r, nil    default:        log.Println(&quot;Acquire:&quot;, &quot;new resource&quot;)        return p.factory()    }}// é‡Šæ”¾èµ„æºå›æ± func (p *Pool) Release(r io.Closer) {    p.m.Lock()    defer p.m.Unlock()    if p.closed {        r.Close()        return    }    select {    case p.resources &amp;lt;- r:        log.Println(&quot;Release:&quot;, &quot;in queue&quot;)    default:        log.Println(&quot;Release:&quot;, &quot;closeing&quot;)        r.Close()    }}// å…³é—­èµ„æºæ± func (p *Pool) Close() {    p.m.Lock()    defer p.m.Unlock()    if p.closed {        return    }    p.closed = true    close(p.resources)    for r := range p.resources {        r.Close()    }}`&lt;/pre&gt;# æµ‹è¯•&lt;pre class=&quot;line-numbers prism-highlight&quot; data-start=&quot;1&quot;&gt;`package mainimport (    &quot;log&quot;    &quot;io&quot;    &quot;sync/atomic&quot;    &quot;mypackages/pool&quot;    &quot;sync&quot;    &quot;time&quot;    &quot;math/rand&quot;)const (    maxGoroutines = 200 // æœ€å¤§åç¨‹æ•°    poolResources = 10  //èµ„æºæ± èµ„æºæ•°)type dbConn struct {    ID int32}func (d *dbConn) Close() error {    log.Println(&quot;close connection:&quot;, d.ID)    return nil}var resourceInt int32// åˆ›å»ºè¿æ¥å·¥å‚å‡½æ•°func createConnection() (io.Closer, error) {    id := atomic.AddInt32(&amp;amp;resourceInt, 1) // åŸå­æ–¹æ³•    log.Println(&quot;createConn:id=&quot;, id)    return &amp;amp;dbConn{        ID: atomic.AddInt32(&amp;amp;id, 1),    }, nil}func main() {    var wg sync.WaitGroup    wg.Add(maxGoroutines)    p, err := pool.New(createConnection, poolResources)    if err != nil {        log.Fatalln(err)    }    for query := 0; query &amp;lt; maxGoroutines; query++ {        go func(q int) {            selectQuery(q, p)            wg.Done()        }(query)    }    wg.Wait()    log.Println(&quot;close pool&quot;)    p.Close()}func selectQuery(q int, pool2 *pool.Pool) {    time.Sleep(time.Millisecond * time.Duration(rand.Intn(1000)))    dbconn, err := pool2.Acquire()    if err != nil {        log.Println(&quot;acquire conn error:&quot;, err)    }    defer pool2.Release(dbconn)    time.Sleep(time.Millisecond * time.Duration(rand.Intn(1000)))    log.Printf(&quot;Qin:%d.Cin%d&quot;, q, dbconn.(*dbConn).ID)}</code></pre>]]></content>
      
      <categories>
          
          <category> go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>go  é€šé“å®ç°è¶…æ—¶æ§åˆ¶ã€æ¥æ”¶ç³»ç»Ÿé€€å‡º</title>
      <link href="/2018/03/19/go-e9-80-9a-e9-81-93-e5-ae-9e-e7-8e-b0-e8-b6-85-e6-97-b6-e6-8e-a7-e5-88-b6-e3-80-81-e6-8e-a5-e6-94-b6-e7-b3-bb-e7-bb-9f-e9-80-80-e5-87-ba/"/>
      <url>/2018/03/19/go-e9-80-9a-e9-81-93-e5-ae-9e-e7-8e-b0-e8-b6-85-e6-97-b6-e6-8e-a7-e5-88-b6-e3-80-81-e6-8e-a5-e6-94-b6-e7-b3-bb-e7-bb-9f-e9-80-80-e5-87-ba/</url>
      <content type="html"><![CDATA[<pre><code>package mainimport (    &quot;os&quot;    &quot;time&quot;    &quot;errors&quot;    &quot;os/signal&quot;    &quot;log&quot;)type Runner struct {    interrupt chan os.Signal   //æ“ä½œç³»ç»Ÿä¿¡å·    complete  chan error       // è¿è¡Œå®Œæˆæ—¶è¿”å›ä¿¡æ¯    timeout   &amp;lt;-chan time.Time // è¶…æ—¶å•å‘é€šé“    tasks     []func(int)      // å­˜å‚¨æ–¹æ³•åˆ‡ç‰‡}//è¶…æ—¶è¿”å›ä¿¡æ¯var ErrTimeout = errors.New(&quot;received timeout&quot;)//ç³»ç»Ÿä¸­ç»ˆæ­¢è¿”å›ä¿¡æ¯var ErrInterrupt = errors.New(&quot;received Interrupt&quot;)//Runnerç”Ÿæˆæ–¹æ³•// os.Signal ç³»ç»Ÿä¿¡æ¯æ¥å£// func After(d Duration) &amp;lt;-chan Time Afterä¼šåœ¨å¦ä¸€çº¿ç¨‹ç»è¿‡æ—¶é—´æ®µdåå‘è¿”å›å€¼å‘é€å½“æ—¶çš„æ—¶é—´func New(d time.Duration) *Runner {    return &amp;amp;Runner{        interrupt: make(chan os.Signal, 1),        complete:  make(chan error),        timeout:   time.After(d),    }}//å‘runnerä¸­æ·»åŠ éœ€è¦è¿è¡Œçš„æ–¹æ³•func (r *Runner) Add(tasks ...func(int)) {    r.tasks = append(r.tasks, tasks...)}//æ‰§è¡Œæ·»åŠ çš„æ¯ä¸€ä¸ªä»»åŠ¡func (r *Runner) run() error {    for id, task := range r.tasks {        if r.gotInterrupt() {            return ErrInterrupt        }        task(id)    }    return nil}//éªŒè¯æ˜¯å¦æ”¶åˆ°ç³»ç»Ÿä¸­æ–­ä¿¡å·func (r *Runner) gotInterrupt() bool {    select {    case &amp;lt;-r.interrupt:        signal.Stop(r.interrupt)        return true    default:        return false    }}// æ‰§è¡Œæ‰€æœ‰ä»»åŠ¡ï¼Œç›‘å¬é€šé“// func Notify(c chan&amp;lt;- os.Signal, sig ...os.Signal)// Notifyå‡½æ•°è®©signalåŒ…å°†è¾“å…¥ä¿¡å·è½¬å‘åˆ°cã€‚å¦‚æœæ²¡æœ‰åˆ—å‡ºè¦ä¼ é€’çš„ä¿¡å·ï¼Œä¼šå°†æ‰€æœ‰è¾“å…¥ä¿¡å·ä¼ é€’åˆ°cï¼›å¦åˆ™åªä¼ é€’åˆ—å‡ºçš„è¾“å…¥ä¿¡å·ã€‚func (r *Runner) Start() error {    signal.Notify(r.interrupt, os.Interrupt)    go func() {        r.complete &amp;lt;- r.run()    }()    select {    case err := &amp;lt;-r.complete:        return err    case &amp;lt;-r.timeout:        return ErrTimeout    }}const timeout = 3 * time.Secondfunc main() {    log.Println(&quot;starting work&quot;)    r := New(timeout)    r.Add(createWork(), createWork(), createWork(), createWork(), createWork(), createWork())    if err := r.Start(); err != nil {        switch err {        case ErrInterrupt:            log.Println(&quot;Terminating due to interrupt&quot;)            os.Exit(1)        case ErrTimeout:            log.Println(&quot;Terminating due to timeout&quot;)            os.Exit(2)        }    }    log.Println(&quot;run end!&quot;)}func createWork() func(int) {    return func(d int) {        log.Printf(&quot;work: %d start&quot;, d)        time.Sleep(time.Duration(d) * time.Second)        log.Printf(&quot;work %d end&quot;, d)    }}</code></pre>]]></content>
      
      <categories>
          
          <category> go </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>ã€Šç®—æ³•ã€‹æ— å‘å›¾--goè¯­è¨€å®ç°</title>
      <link href="/2018/01/20/e5-9b-be-e7-9a-84-e6-b7-b1-e5-ba-a6-e4-bc-98-e5-85-88-e6-90-9c-e7-b4-a2-go-e8-af-ad-e8-a8-80-e5-ae-9e-e7-8e-b0/"/>
      <url>/2018/01/20/e5-9b-be-e7-9a-84-e6-b7-b1-e5-ba-a6-e4-bc-98-e5-85-88-e6-90-9c-e7-b4-a2-go-e8-af-ad-e8-a8-80-e5-ae-9e-e7-8e-b0/</url>
      <content type="html"><![CDATA[<h1 id="æ— å‘å›¾â€“goè¯­è¨€å®ç°ï¼ˆæŒç»­æ›´æ–°ï¼‰"><a href="#æ— å‘å›¾â€“goè¯­è¨€å®ç°ï¼ˆæŒç»­æ›´æ–°ï¼‰" class="headerlink" title="æ— å‘å›¾â€“goè¯­è¨€å®ç°ï¼ˆæŒç»­æ›´æ–°ï¼‰"></a>æ— å‘å›¾â€“goè¯­è¨€å®ç°ï¼ˆæŒç»­æ›´æ–°ï¼‰</h1><blockquote><p>åœ¨è®¸å¤šè®¡ç®—æœºåº”ç”¨ä¸­ï¼Œç”±ç›¸è¿çš„ç»“ç‚¹æ‰€è¡¨ç¤ºçš„æ¨¡å‹èµ·åˆ°äº†å…³é”®çš„ä½œç”¨ã€‚è¿™äº›ç»“ç‚¹ä¹‹é—´çš„è¿æ¥å¾ˆ è‡ªç„¶åœ°ä¼šè®©äººä»¬äº§ç”Ÿä¸€è¿ä¸²çš„ç–‘é—®:æ²¿ç€è¿™äº›è¿æ¥èƒ½å¦ä»ä¸€ä¸ªç»“ç‚¹åˆ°è¾¾å¦ä¸€ä¸ªç»“ç‚¹?æœ‰å¤šå°‘ä¸ªç»“ç‚¹ å’ŒæŒ‡å®šçš„ç»“ç‚¹ç›¸è¿?ä¸¤ä¸ªç»“ç‚¹ä¹‹é—´æœ€çŸ­çš„è¿æ¥æ˜¯å“ªä¸€æ¡?<br>  è¦æè¿°è¿™äº›é—®é¢˜ï¼Œæˆ‘ä»¬è¦ä½¿ç”¨ä¸€ç§æŠ½è±¡çš„æ•°å­¦å¯¹è±¡ï¼Œå«åšå›¾<br>      æ‘˜è‡ªã€Šç®—æ³•ã€‹</p></blockquote><h4 id="å›¾çš„æ•°æ®ç»“æ„å’ŒåŸºæœ¬æ“ä½œ"><a href="#å›¾çš„æ•°æ®ç»“æ„å’ŒåŸºæœ¬æ“ä½œ" class="headerlink" title="å›¾çš„æ•°æ®ç»“æ„å’ŒåŸºæœ¬æ“ä½œ"></a>å›¾çš„æ•°æ®ç»“æ„å’ŒåŸºæœ¬æ“ä½œ</h4><pre><code>package graphimport (    &quot;container/list&quot;)// å›¾çš„æ•°æ®ç»“æ„type Graph struct {    v   int          // é¡¶ç‚¹æ•°    e   int          // è¾¹æ•°    adj []*list.List // é‚»è¾¹é“¾è¡¨åˆ‡ç‰‡}// åˆ›å»ºä¸€ä¸ªå›¾func New(v int, e [][2]int) *Graph {    graph := new(Graph)    graph.v = v    graph.e = len(e)    var adj []*list.List    for i := 0; i &amp;lt; v; i++ {        adj = append(adj, list.New())    }    graph.adj = adj    for _, val := range e {        graph.AddEdge(val[0], val[1])    }    return graph}// è·å–å›¾çš„å®šç‚¹æ•°é‡func (g *Graph) V() int {    return g.v}// è·å–å›¾ä¸­è¾¹çš„æ•°é‡func (g *Graph) E() int {    return g.e}// å‘å›¾ä¸­æ·»åŠ ä¸€æ¡è¾¹func (g *Graph) AddEdge(v int, w int) {    g.adj[v].PushFront(w)    g.adj[w].PushFront(v)}// è·å–ä¸é¡¶ç‚¹ç›¸é€šçš„å…¶ä»–é¡¶ç‚¹ è¿”å›ä¸€ä¸ªé“¾è¡¨func (g *Graph) Adj(v int) *list.List {    return g.adj[v]}`&lt;/pre&gt;#### æ·±åº¦ä¼˜å…ˆæœç´¢&lt;pre class=&quot;line-numbers prism-highlight&quot; data-start=&quot;1&quot;&gt;`package graph/**æ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³• */type depth struct {    marked []bool    count  int}func NewDepth(g *Graph, s int) *depth {    depth := &amp;amp;depth{        marked: make([]bool, g.v),        count:  0,    }    depth.dfs(g, s)    return depth}// åˆ©ç”¨é€’å½’å®ç°å›¾æ·±åº¦ä¼˜å…ˆæœç´¢func (d *depth) dfs(g *Graph, v int) {    d.marked[v] = true    d.count++    for e := g.Adj(v).Front(); e != nil; e = e.Next() {        w, _ := e.Value.(int)        if !d.marked[w] {            d.dfs(g, w)        }    }}// åˆ¤æ–­ä¼ å…¥çš„é¡¶ç‚¹æ˜¯å¦ä¸åˆå§‹é¡¶ç‚¹ç›¸é€šfunc (d *depth) Marked(w int) bool {    return d.marked[w]}// å’Œåˆå§‹é¡¶ç‚¹ç›¸é€šçš„é¡¶ç‚¹æ•°é‡func (d *depth) Count() int {    return d.count}`&lt;/pre&gt;#### æ·±åº¦ä¼˜å…ˆæœç´¢è·¯å¾„&lt;pre class=&quot;line-numbers prism-highlight&quot; data-start=&quot;1&quot;&gt;`package graphtype Paths struct {    marked []bool    edgeTo []int    final  int}func NewPaths(graph *Graph, s int) *Paths {    paths := &amp;amp;Paths{        marked: make([]bool, graph.V()),        edgeTo: make([]int, graph.V()),        final:  s,    }    paths.dfs(graph, s)    return paths}func (p *Paths) dfs(graph *Graph, v int) {    p.marked[v] = true    for e := graph.Adj(v).Front(); e != nil; e = e.Next() {        w, _ := e.Value.(int)        if !p.marked[w] {            p.edgeTo[w] = v            p.dfs(graph, w)        }    }}func (p *Paths) HasPathTo(v int) bool {    return p.marked[v]}func (p *Paths) PathTo(v int) []int {    if !p.HasPathTo(v) {        return nil    }    path := make([]int, 0)    var x int    for x = v; x != p.final; x = p.edgeTo[x] {        path = append(path, x)    }    path = append(path, x)    return path}`&lt;/pre&gt;#### å¹¿åº¦ä¼˜å…ˆæœç´¢æœ€çŸ­è·¯å¾„&lt;pre class=&quot;line-numbers prism-highlight&quot; data-start=&quot;1&quot;&gt;`package graphimport &quot;container/list&quot;/***å¹¿åº¦ä¼˜å…ˆæœç´¢*/type Breadth struct {    marked []bool    edgeTo []int    final  int}func NewBreadth(graph *Graph, s int) *Breadth {    breadth := &amp;amp;Breadth{        marked: make([]bool, graph.v),        edgeTo: make([]int, graph.v),        final:  s,    }    breadth.bfs(graph, s)    return breadth}func (b *Breadth) bfs(graph *Graph, s int) {    queue := list.New()    b.marked[s] = true    queue.PushBack(s)    for queue.Len() != 0 {        element := queue.Front()        v, _ := queue.Remove(element).(int)        for e := graph.Adj(v).Front(); e != nil; e = e.Next() {            val, _ := e.Value.(int)            if b.marked[val] == false {                b.marked[val] = true                b.edgeTo[val] = v                queue.PushBack(e.Value)            }        }    }}func (b *Breadth) HasPathTo(v int) bool {    return b.marked[v]}func (b *Breadth) Path(v int) []int {    if !b.HasPathTo(v) {        return nil    }    path := make([]int, 0)    for p := v; p != b.final;p = b.edgeTo[p] {        path = append(path,p)    }    path = append(path,b.final)    return path}`&lt;/pre&gt;#### æœ€åæµ‹è¯•&lt;pre class=&quot;line-numbers prism-highlight&quot; data-start=&quot;1&quot;&gt;`package mainimport (    &quot;graph&quot;    &quot;fmt&quot;)func main() {    data := [][2]int{        {0, 1},        {1, 3},        {0, 3},    }    g := graph.New(4, data)    //depth := graph.NewDepth(g, 1)    //fmt.Println(depth.Marked(3))    //paths := graph.NewPaths(g, 0)    //fmt.Println(paths.PathTo(3))    paths := graph.NewBreadth(g, 0)    fmt.Println(paths.Path(3))}</code></pre>]]></content>
      
      <categories>
          
          <category> go </category>
          
          <category> ç®—æ³•æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>JS æ—¶é—´æ ¼å¼åŒ–ä»£ç ç‰‡æ®µ</title>
      <link href="/2017/12/28/js-e6-97-b6-e9-97-b4-e6-a0-bc-e5-bc-8f-e5-8c-96-e4-bb-a3-e7-a0-81-e7-89-87-e6-ae-b5/"/>
      <url>/2017/12/28/js-e6-97-b6-e9-97-b4-e6-a0-bc-e5-bc-8f-e5-8c-96-e4-bb-a3-e7-a0-81-e7-89-87-e6-ae-b5/</url>
      <content type="html"><![CDATA[<pre><code>Date.prototype.Format = function (fmt) {          var o = {            &quot;M+&quot;: this.getMonth() + 1, //æœˆä»½             &quot;d+&quot;: this.getDate(), //æ—¥             &quot;h+&quot;: this.getHours(), //å°æ—¶             &quot;m+&quot;: this.getMinutes(), //åˆ†             &quot;s+&quot;: this.getSeconds(), //ç§’             &quot;q+&quot;: Math.floor((this.getMonth() + 3) / 3), //å­£åº¦             &quot;S&quot;: this.getMilliseconds() //æ¯«ç§’         };        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (this.getFullYear() + &quot;&quot;).substr(4 - RegExp.$1.length));        for (var k in o)        if (new RegExp(&quot;(&quot; + k + &quot;)&quot;).test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : ((&quot;00&quot; + o[k]).substr((&quot;&quot; + o[k]).length)));        return fmt;    };</code></pre><p>ä½¿ç”¨ç¤ºä¾‹ï¼š<br><code>new Date().Formet(&quot;yyyy-MM-dd&quot;)</code></p>]]></content>
      
      <categories>
          
          <category> js </category>
          
      </categories>
      
      
        <tags>
            
            <tag> js </tag>
            
            <tag> jsæ—¶é—´æ ¼å¼åŒ– </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>é«˜å¹¶å‘ä¸‹çš„mysqlé—®é¢˜</title>
      <link href="/2017/12/26/e9-ab-98-e5-b9-b6-e5-8f-91-e4-b8-8b-e7-9a-84mysql-e9-97-ae-e9-a2-98/"/>
      <url>/2017/12/26/e9-ab-98-e5-b9-b6-e5-8f-91-e4-b8-8b-e7-9a-84mysql-e9-97-ae-e9-a2-98/</url>
      <content type="html"><![CDATA[<h1 id="1-mysql-é‡å¤æ’å…¥é—®é¢˜"><a href="#1-mysql-é‡å¤æ’å…¥é—®é¢˜" class="headerlink" title="1 mysql é‡å¤æ’å…¥é—®é¢˜"></a>1 mysql é‡å¤æ’å…¥é—®é¢˜</h1><blockquote><p>ä¸šåŠ¡éœ€è¦å…ˆæ ¹æ®whereæ¡ä»¶æŸ¥è¯¢ï¼Œå¦‚æœ‰æ•°æ®å‘½ä¸­å¯¹å…¶è¿›è¡Œä¿®æ”¹å¦åˆ™åˆ›å»ºä¸€æ¡æ–°çš„è®°å½•ã€‚å®è·µä¸­å‘ç°ï¼šè¯¥æ“ä½œåœ¨é‡åˆ°å¹¶å‘å¤„ç†æ—¶ä¼šå‘ç”Ÿé‡å¤åˆ›å»º</p></blockquote><h4 id="è§£å†³æ–¹å¼"><a href="#è§£å†³æ–¹å¼" class="headerlink" title="è§£å†³æ–¹å¼"></a>è§£å†³æ–¹å¼</h4><p>æ·»åŠ å”¯ä¸€ç´¢å¼•æˆ–å¤šåˆ—å”¯ä¸€ç´¢å¼•ï¼Œè¿™æ ·å½“æœ‰é‡å¤åˆ›å»ºæ—¶æ•°æ®åº“æŠ¥é”™ï¼Œäº¤ç”±ç¨‹åºå¤„ç†ã€‚è¿™ç§å¤„ç†æ–¹å¼ä¸ºä¹è§‚é”ï¼Œé€‚åˆå†²çªå‘ç”Ÿç‡æ¯”è¾ƒä½çš„æƒ…å†µã€‚</p><h1 id="2-mysql-set-update-å¹¶å‘è„è¯»é—®é¢˜"><a href="#2-mysql-set-update-å¹¶å‘è„è¯»é—®é¢˜" class="headerlink" title="2 mysql set update å¹¶å‘è„è¯»é—®é¢˜"></a>2 mysql set update å¹¶å‘è„è¯»é—®é¢˜</h1><blockquote><p>å¯¹ä¸€æ¡æ•°æ®è¿›è¡Œç´¯åŠ æ—¶å¸¸å¸¸å…ˆä½¿ç”¨selectè¯­å¥æŸ¥è¯¢ï¼Œç„¶ååœ¨æŸ¥è¯¢çš„æ•°å€¼ä¸ŠåŠ ä¸Šä¸€ä¸ªæ•°å€¼ï¼Œåœ¨update æ›´æ–°å›æ•°æ®åº“ã€‚ è¿™æ ·æ“ä½œåœ¨å¹¶å‘å¤„ç†ä¸­ä¼šå‡ºç°è„è¯»é—®é¢˜ï¼Œä¾‹å¦‚ï¼šä¸¤ä¸ªè¿›ç¨‹åŒæ—¶å¤„ç†ç›¸åŒä¸€æ¡æ•°æ®ï¼ŒåŒæ—¶è¯»å–äº†å½“å‰çš„æ•°å€¼ä¸º200ï¼Œè¿›ç¨‹1å¤„ç†çš„æ¯”è¾ƒå¿«åœ¨2000çš„åŸºç¡€ä¸ŠåŠ ä¸Šäº†3000ï¼ˆ2000 + 3000ï¼‰ï¼Œæ›´æ–°å›æ•°æ®åº“ï¼ˆæ­¤æ—¶æ•°æ®ä¸º5000ï¼‰ï¼Œè¿›ç¨‹2ä¹Ÿåœ¨åŸ2000åŸºç¡€ä¸ŠåŠ ä¸Šäº†2000ï¼ˆ2000 + 2000ï¼‰ï¼Œä¹Ÿæ›´æ–°ä¼šæ•°æ®åº“ã€‚æœ€ç»ˆæ•°æ®åº“æ•°å€¼ä¸º4000ï¼Œæ­£ç¡®çš„åº”ä¸º2000+3000+2000=7000.</p></blockquote><h4 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h4><p>å¯¹æ•°æ®åŠ ç‹¬å é”ï¼š</p><p>å…±äº«é”ï¼ˆSï¼‰ï¼šSELECT * FROM table_name WHERE â€¦ LOCK IN SHARE MODEã€‚</p><p>æ’ä»–é”ï¼ˆX)ï¼šSELECT * FROM table_name WHERE â€¦ FOR UPDATEã€‚</p><p>åœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨æ’ä»–é”å¯¹éœ€è¦ä¿®æ”¹çš„æ•°æ®åŠ é”ï¼Œè¿™æ ·åœ¨æ•´ä¸ªæŸ¥è¯¢ã€ä¿®æ”¹çš„äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå…¶ä»–äº‹åŠ¡å°†æ— æ³•è¯»å–æ•°æ®ï¼Œç›´åˆ°è¯¥äº‹åŠ¡å¤„ç†å®Œæ¯•ã€‚è¿™ç§æ“ä½œæ–¹å¼ä¸ºæ‚²è§‚é”ã€‚ å°†å¹¶è¡Œå¤„ç†æ”¹ä¸ºä¸²è¡Œå¤„ç†ã€‚</p><h4 id="SQLAlchemy-çš„-Query-æ”¯æŒ-select-â€¦-for-update-share"><a href="#SQLAlchemy-çš„-Query-æ”¯æŒ-select-â€¦-for-update-share" class="headerlink" title="SQLAlchemy çš„ Query æ”¯æŒ select â€¦ for update / share ."></a>SQLAlchemy çš„ Query æ”¯æŒ select â€¦ for update / share .</h4><pre><code>session.Query(User).with_for_update().first()session.Query(User).with_for_update(read=True).first()`&lt;/pre&gt;å®Œæ•´å½¢å¼æ˜¯:&lt;pre class=&quot;line-numbers prism-highlight&quot; data-start=&quot;1&quot;&gt;`with_for_update(read=False, nowait=False, of=None)</code></pre><blockquote><p>read</p><p>  æ˜¯æ ‡è¯†åŠ äº’æ–¥é”è¿˜æ˜¯å…±äº«é”. å½“ä¸º True æ—¶, å³ for share çš„è¯­å¥, æ˜¯å…±äº«é”. å¤šä¸ªäº‹åŠ¡å¯ä»¥è·å–å…±äº«é”, äº’æ–¥é”åªèƒ½ä¸€ä¸ªäº‹åŠ¡è·å–. æœ‰â€å¤šä¸ªåœ°æ–¹â€éƒ½å¸Œæœ›æ˜¯â€è¿™æ®µæ—¶é—´æˆ‘è·å–çš„æ•°æ®ä¸èƒ½è¢«ä¿®æ”¹, æˆ‘ä¹Ÿä¸ä¼šæ”¹â€, é‚£ä¹ˆåªèƒ½ä½¿ç”¨å…±äº«é”.</p><p>  nowait</p><p>  å…¶å®ƒäº‹åŠ¡ç¢°åˆ°é”, æ˜¯å¦ä¸ç­‰å¾…ç›´æ¥â€æŠ¥é”™â€.</p><p>  of</p><p>  æŒ‡æ˜ä¸Šé”çš„è¡¨, å¦‚æœä¸æŒ‡æ˜, åˆ™æŸ¥è¯¢ä¸­æ¶‰åŠçš„æ‰€æœ‰è¡¨(è¡Œ)éƒ½ä¼šåŠ é”.</p></blockquote>]]></content>
      
      <categories>
          
          <category> mysql </category>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> flask </tag>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Laravel+scout+elasticsearchå®ç°å…¨æ–‡æœç´¢</title>
      <link href="/2017/12/21/laravelscoutelasticsearch-e5-ae-9e-e7-8e-b0-e5-85-a8-e6-96-87-e6-90-9c-e7-b4-a2/"/>
      <url>/2017/12/21/laravelscoutelasticsearch-e5-ae-9e-e7-8e-b0-e5-85-a8-e6-96-87-e6-90-9c-e7-b4-a2/</url>
      <content type="html"><![CDATA[<h1 id="Laravelä¸­ä½¿ç”¨elasticsearchå®ç°å…¨æ–‡æœç´¢"><a href="#Laravelä¸­ä½¿ç”¨elasticsearchå®ç°å…¨æ–‡æœç´¢" class="headerlink" title="Laravelä¸­ä½¿ç”¨elasticsearchå®ç°å…¨æ–‡æœç´¢"></a>Laravelä¸­ä½¿ç”¨elasticsearchå®ç°å…¨æ–‡æœç´¢</h1><blockquote><p>é¡¹ç›®ä¸­è¦åšæœç´¢,æ¬²é‡‡ç”¨Laravel+Scoutæ‰©å±• +elasticsearchæ¥å®ç°ï¼Œç‰¹è®°å½•å¤‡ç”¨</p></blockquote><h2 id="elasticå®‰è£…"><a href="#elasticå®‰è£…" class="headerlink" title="elasticå®‰è£…"></a>elasticå®‰è£…</h2><ol><li>å®˜ç½‘ä¸‹è½½5.6.4ç‰ˆæœ¬zipæ–‡ä»¶ï¼Œè§£å‹åˆ°ç›®æ ‡ç›®å½•ï¼Œè¿è¡Œéœ€è¦Java1.8è¿è¡Œç¯å¢ƒã€‚<p></p></li><li><p>å®‰è£…åˆ†è¯æ‰©å±•ikï¼Œåœ¨elasticsearchç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤</p><pre><code>./bin/elasticsearch-plugin install https://github.com/medcl/elasticsearch-analysis-ik/releases/download/v5.6.4/elasticsearch-analysis-ik-5.6.4.zip</code></pre><p>`</p></li><li>æŸ¥çœ‹å®‰è£…çš„æ‰©å±•åˆ—è¡¨<pre class="line-numbers prism-highlight" data-start="1">`./bin/elasticsearch-plugin list`</pre></li><li>å¯åŠ¨ <code>./bin/elasticsearch</code></li><li><p>æœ¬åœ°è®¿é—® <code>http://localhost:9200/?pretty</code> æŸ¥çœ‹å¯åŠ¨æˆåŠŸ</p><h2 id="Laravelæ‰©å±•"><a href="#Laravelæ‰©å±•" class="headerlink" title="Laravelæ‰©å±•"></a>Laravelæ‰©å±•</h2><p></p><p>Laravelä½¿ç”¨çš„5.4ç‰ˆæœ¬ï¼Œä½¿ç”¨å®˜æ–¹Scoutå…¨æ–‡æœç´¢æ‰©å±•å’Œé’ˆå¯¹Scoutçš„elasticå¼•æ“laravel-scout-elastic,ä½¿ç”¨åªéœ€å®‰è£…tamayo/laravel-scout-elasticï¼Œå®ƒä¼šä¾èµ–ä¸‹è½½Scoutã€‚</p><pre class="line-numbers prism-highlight" data-start="1">`composer require tamayo/laravel-scout-elastic`</pre><p>æ·»åŠ æœåŠ¡æä¾›è€…</p><pre class="line-numbers prism-highlight" data-start="1">`// config/app.php'providers' =&gt; [    ...    Laravel\Scout\ScoutServiceProvider::class,    ...    ScoutEngines\Elasticsearch\ElasticsearchProvider::class,],`</pre><p>ç”Ÿæˆscouté…ç½®</p><pre class="line-numbers prism-highlight" data-start="1">`php artisan vendor:publish --provider="Laravel\Scout\ScoutServiceProvider"`</pre><p>æ·»åŠ Elasticå¼•æ“é…ç½®</p><p><pre class="line-numbers prism-highlight" data-start="1">`// config/scout.php<br>// Set your driver to elasticsearch</pre></p><pre><code>&apos;driver&apos; =&amp;gt; env(&apos;SCOUT_DRIVER&apos;, &apos;elasticsearch&apos;),// Elasticå¼•æ“é…ç½®&apos;elasticsearch&apos; =&amp;gt; [        //elasticç´¢å¼•åç§°    &apos;index&apos; =&amp;gt; env(&apos;ELASTICSEARCH_INDEX&apos;, &apos;laravel&apos;),    // elastic è®¿é—®åœ°å€    &apos;hosts&apos; =&amp;gt; [        env(&apos;ELASTICSEARCH_HOST&apos;, &apos;http://localhost&apos;),    ],],</code></pre></li></ol><p>è‡³æ­¤å‰æœŸå‡†å¤‡é…ç½®å°±ç®—å®Œæˆäº†</p><h2 id="Scoutä½¿ç”¨"><a href="#Scoutä½¿ç”¨" class="headerlink" title="Scoutä½¿ç”¨"></a>Scoutä½¿ç”¨</h2><p>å…·ä½“Scoutæ‰©å±•çš„ä½¿ç”¨å¯æŸ¥è¯¢<a href="https://d.laravel-china.org/docs/5.4/scout#pagination" target="_blank" rel="noopener">æ–‡æ¡£</a></p>]]></content>
      
      <categories>
          
          <category> Laravel </category>
          
      </categories>
      
      
        <tags>
            
            <tag> elasticsearch </tag>
            
            <tag> scout </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>go æ ‡å‡†åº“logä½¿ç”¨</title>
      <link href="/2017/12/17/go-e6-a0-87-e5-87-86-e5-ba-93log-e4-bd-bf-e7-94-a8/"/>
      <url>/2017/12/17/go-e6-a0-87-e5-87-86-e5-ba-93log-e4-bd-bf-e7-94-a8/</url>
      <content type="html"><![CDATA[<pre><code>package mainimport (    &quot;log&quot;    &quot;os&quot;    &quot;io/ioutil&quot;    &quot;io&quot;)var (    Trace   *log.Logger    Info    *log.Logger    Warning *log.Logger    Error   *log.Logger)func init() {    file, err := os.OpenFile(&quot;error.txt&quot;, os.O_CREATE|os.O_WRONLY|os.O_APPEND, 0666)    if err != nil {        log.Fatalln(&quot;Fatal to open error log file:&quot;, err)    }    Trace = log.New(ioutil.Discard,        &quot;Trace: &quot;,        log.Ldate|log.Ltime|log.Lshortfile)    Info = log.New(os.Stdout,        &quot;Info: &quot;,        log.Ldate|log.Ltime|log.Lshortfile)    Warning = log.New(os.Stdout,        &quot;Warning: &quot;,        log.Ldate|log.Ltime|log.Lshortfile)    Error = log.New(io.MultiWriter(file, os.Stderr),        &quot;Error: &quot;,        log.Ldate|log.Ltime|log.Lshortfile)}func main() {    Trace.Println(&quot;this is  Trace&quot;)    Info.Println(&quot;this is Info&quot;)    Warning.Println(&quot;this is Warning&quot;)    Error.Println(&quot;this is Errer&quot;)}</code></pre>]]></content>
      
      <categories>
          
          <category> go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> go </tag>
            
            <tag> log </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>explain è¯¦ç»†å‚æ•°</title>
      <link href="/2017/10/21/explain-e8-af-a6-e7-bb-86-e5-8f-82-e6-95-b0/"/>
      <url>/2017/10/21/explain-e8-af-a6-e7-bb-86-e5-8f-82-e6-95-b0/</url>
      <content type="html"><![CDATA[<blockquote><p>å¹³æ—¶åˆ†æsqlè¯­å¥ç»å¸¸ä½¿ç”¨explain æŸ¥çœ‹æ‰§è¡Œæƒ…å†µï¼Œä¸€äº›ç»†èŠ‚ç‰¹è¯¦ç»†è®°å½•ç”¨ä»¥å¤‡å¿˜ã€‚</p></blockquote><p>å‘ç°ç®€ä¹¦æœ‰ç¯‡æ€»ç»“çš„å¾ˆè¯¦ç»†ï¼Œå·ä¸ªæ‡’ ğŸ˜<br><a href="http://www.jianshu.com/p/ea3fc71fdc45" target="_blank" rel="noopener">è¿™æ˜¯é“¾æ¥</a></p>]]></content>
      
      <categories>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> explain </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ’åºç®—æ³•ï¼ˆæ’å…¥æ’åºã€å¸Œå°”æ’åºã€å †æ’åºã€å½’å¹¶æ’åºã€å¿«é€Ÿæ’åºï¼‰</title>
      <link href="/2017/09/26/e6-8e-92-e5-ba-8f-e7-ae-97-e6-b3-95-ef-bc-88-e6-8f-92-e5-85-a5-e6-8e-92-e5-ba-8f-e3-80-81-e5-b8-8c-e5-b0-94-e6-8e-92-e5-ba-8f-e3-80-81-e5-a0-86-e6-8e-92-e5-ba-8f-e3-80-81-e5-bd-92-e5-b9-b6-e6-8e-92/"/>
      <url>/2017/09/26/e6-8e-92-e5-ba-8f-e7-ae-97-e6-b3-95-ef-bc-88-e6-8f-92-e5-85-a5-e6-8e-92-e5-ba-8f-e3-80-81-e5-b8-8c-e5-b0-94-e6-8e-92-e5-ba-8f-e3-80-81-e5-a0-86-e6-8e-92-e5-ba-8f-e3-80-81-e5-bd-92-e5-b9-b6-e6-8e-92/</url>
      <content type="html"><![CDATA[<h3 id="æ’å…¥æ’åºã€å¸Œå°”æ’åºã€å †æ’åºã€å½’å¹¶æ’åº-â€“cè¯­è¨€å®ç°"><a href="#æ’å…¥æ’åºã€å¸Œå°”æ’åºã€å †æ’åºã€å½’å¹¶æ’åº-â€“cè¯­è¨€å®ç°" class="headerlink" title="æ’å…¥æ’åºã€å¸Œå°”æ’åºã€å †æ’åºã€å½’å¹¶æ’åº â€“cè¯­è¨€å®ç°"></a>æ’å…¥æ’åºã€å¸Œå°”æ’åºã€å †æ’åºã€å½’å¹¶æ’åº â€“cè¯­è¨€å®ç°</h3><p>é€æ¸æ·»åŠ ä¸­â€¦.</p><pre><code>#include &amp;lt;stdio.h&amp;gt;#include &amp;lt;stdlib.h&amp;gt;#define LeftChild(i) (2 * (i) + 1)#define FatalError(str) fprintf(stderr, &quot;%s\n&quot;, str), exit(1);void IntertionSort(int data[], int n);void ShellSort(int data[], int n);void HeapSort(int data[], int n);void PercDown(int data[], int i, int n);void Swap(int *a, int *b);void MergeSort(int DataArray[], int n);void MSort(int DataArray[], int TmpArray[], int Left, int Right);void Merge(int DataArray[], int TmpArray[], int Left, int Center, int Right);int main(){    int n;    int data[] = {1, 5, 6, 2, 44, 7, 34, 67, 66};    // IntertionSort(data, sizeof(data) / sizeof(int));    // ShellSort(data, sizeof(data) / sizeof(int));    // HeapSort(data, sizeof(data) / sizeof(int));    MergeSort(data, sizeof(data) / sizeof(int));    for (n = 0; n &amp;lt; sizeof(data) / sizeof(int); n++)    {        printf(&quot;%d\n&quot;, data[n]);    }}// æ’å…¥æ’åº O(NÂ²)void IntertionSort(int data[], int n){    int k, j;    for (k = 1; k &amp;lt; n; k++)    {        int tmp = data[k];        for (j = k; j &amp;gt; 0 &amp;amp;&amp;amp; data[j - 1] &amp;gt; tmp; j--)        {            data[j] = data[j - 1];        }        data[j] = tmp;    }}// å¸Œå°”æ’åº O(NÂ²)void ShellSort(int data[], int n){    int i, j, increment, tmp;    for (increment = n / 2; increment &amp;gt; 0; increment /= 2)    {        for (i = increment; i &amp;lt; n; i++)        {            tmp = data[i];            for (j = i; j &amp;gt;= increment; j -= increment)            {                if (tmp &amp;lt; data[j - increment])                {                    data[j] = data[j - increment];                }                else                {                    break;                }            }            data[j] = tmp;        }    }}// å †æ’åº å¤æ‚åº¦:NlogN - O(N)void HeapSort(int data[], int n){    int i;    for (i = n / 2; i &amp;gt;= 0; i--)    {        PercDown(data, i, n);    }    for (i = n - 1; i &amp;gt;= 0; i--)    {        Swap(&amp;amp;data[0], &amp;amp;data[i]);        PercDown(data, 0, i);    }}// èŠ‚ç‚¹ä¸Šè™‘void PercDown(int data[], int i, int n){    int Tmp;    int Child;    for (Tmp = data[i]; LeftChild(i) &amp;lt; n; i = Child)    {        Child = LeftChild(i);        if (Child != n - 1 &amp;amp;&amp;amp; data[Child + 1] &amp;gt; data[Child])        {            Child++;        }        if (Tmp &amp;lt; data[Child])        {            data[i] = data[Child];        }        else        {            break;        }    }    data[i] = Tmp;}void Swap(int *a, int *b){    int tmp;    tmp = *a;    *a = *b;    *b = tmp;}// å½’å¹¶æ’åº å¤æ‚åº¦ O(NlogN)void MSort(int DataArray[], int TmpArray[], int Left, int Right){    int Center;    if (Left &amp;lt; Right)    {        Center = (Left + Right) / 2;        MSort(DataArray, TmpArray, Left, Center);        MSort(DataArray, TmpArray, Center + 1, Right);        Merge(DataArray, TmpArray, Left, Center + 1, Right);    }}void MergeSort(int DataArray[], int n){    int *TmpArray;    TmpArray = malloc(n * sizeof(int));    if (TmpArray != NULL)    {        MSort(DataArray, TmpArray, 0, n - 1);        free(TmpArray);    }    else    {        FatalError(&quot;not space TmpArray!!!&quot;);    }}void Merge(int DataArray[], int TmpArray[], int Left, int Center, int RightEnd){    int i, LeftEnd, TmpPos, NumElements;    LeftEnd = Center - 1;    TmpPos = Left;    NumElements = RightEnd - Left + 1;    while (Left &amp;lt;= LeftEnd &amp;amp;&amp;amp; Center &amp;lt;= RightEnd)    {        if (DataArray[Left] &amp;lt; DataArray[Center])        {            TmpArray[TmpPos++] = DataArray[Left++];        }        else        {            TmpArray[TmpPos++] = DataArray[Center++];        }    }    while (Left &amp;lt;= LeftEnd)    {        TmpArray[TmpPos++] = DataArray[Left++];    }    while (Center &amp;lt;= RightEnd)    {        TmpArray[TmpPos++] = DataArray[Center++];    }    for (i = 0; i &amp;lt; NumElements; i++, RightEnd--)    {        DataArray[RightEnd] = TmpArray[RightEnd];    }}`&lt;/pre&gt;###### å¿«é€Ÿæ’åº&lt;pre class=&quot;line-numbers prism-highlight&quot; data-start=&quot;1&quot;&gt;`// å¿«é€Ÿæ’åºvoid QuickSort(int d[], int n){    QSort(d, 0, n - 1);}void QSort(int d[], int left, int right){    int median, i, j;    if (left + cutoff &amp;lt;= right)    {        median = Median3(d, left, right);        i = left;        j = right - 1;        for (;;)        {            while (d[++i] &amp;lt; median)            {            }            while (d[--j] &amp;gt; median)            {            }            if (i &amp;lt; j)                Swap(&amp;amp;d[i], &amp;amp;d[j]);            else                break;        }        Swap(&amp;amp;d[i], &amp;amp;d[right - 1]);        QSort(d, left, i - 1);        QSort(d, i + 1, right);    }    else    {        IntertionSort(d + left, right - left + 1);    }}int Median3(int d[], int left, int right){    int median;    median = (left + right) / 2;    if (d[left] &amp;gt; d[median])    {        Swap(&amp;amp;d[left], &amp;amp;d[median]);    }    if (d[left] &amp;gt; d[right])    {        Swap(&amp;amp;d[left], &amp;amp;d[right]);    }    if (d[median] &amp;gt; d[right])    {        Swap(&amp;amp;d[median], &amp;amp;d[right]);    }    Swap(&amp;amp;d[median], &amp;amp;d[right - 1]);    return d[right - 1];}</code></pre>]]></content>
      
      <categories>
          
          <category> c </category>
          
          <category> ç®—æ³•æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³•åˆ†æ ä»è¯­è¨€æè¿° </tag>
            
            <tag> c </tag>
            
            <tag> æ’åº </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Avlå¹³è¡¡æ ‘-Cè¯­è¨€å®ç°</title>
      <link href="/2017/09/03/Avl%E5%B9%B3%E8%A1%A1%E6%A0%91-C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0/"/>
      <url>/2017/09/03/Avl%E5%B9%B3%E8%A1%A1%E6%A0%91-C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0/</url>
      <content type="html"><![CDATA[<h3 id="Avl-å¹³è¡¡æ ‘-å®ç°è®°å½•"><a href="#Avl-å¹³è¡¡æ ‘-å®ç°è®°å½•" class="headerlink" title="Avl å¹³è¡¡æ ‘ å®ç°è®°å½•"></a>Avl å¹³è¡¡æ ‘ å®ç°è®°å½•</h3><p><img src="https://upload-images.jianshu.io/upload_images/4560878-e7826f024d26a1a8.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/700" alt=""></p><p>Avlå¹³è¡¡äºŒå‰æ ‘å’Œæœç´¢äºŒå‰æ ‘åŸºæœ¬å®ç°åŸç†ç›¸åŒï¼Œåœ¨æœç´¢äºŒå‰æ ‘çš„åŸºç¡€ä¸Šæ·»åŠ æ ‘å¹³è¡¡çš„æ“ä½œâ€“å•æ—‹å’ŒåŒæ—‹ï¼ˆè¿™ä¹Ÿæ˜¯AvlTreeçš„é‡éš¾ç‚¹ï¼‰ã€‚æ’å…¥æ•°æ®å’Œåˆ é™¤æ•°æ®çš„æ—¶å€™å¯¹æ ‘è¿›è¡Œå¹³è¡¡è°ƒæ•´ã€‚</p><blockquote><p>éœ€è¦æ³¨æ„ï¼šåœ¨åˆ é™¤æ ‘èŠ‚ç‚¹çš„æ“ä½œä¸­ï¼Œè¦æ³¨æ„æ›´æ–°è°ƒæ•´å„èŠ‚ç‚¹ä¸­é«˜åº¦ï¼ˆHeightï¼‰çš„å€¼ã€‚Googleæœç´¢ç»“æœä¸­çœ‹äº†å‰å‡ ä¸ªå®ç°AvlTreeçš„æ–‡ç« ï¼ŒåŸºæœ¬éƒ½æ²¡è€ƒè™‘èŠ‚ç‚¹Heightå±æ€§çš„æ›´æ–°ã€‚</p></blockquote><p>å®ç°ä»£ç <br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> &amp;lt;stdio.h&amp;gt;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> &amp;lt;stdlib.h&amp;gt;</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FatalError(str) fprintf(stderr, <span class="meta-string">"%s\n"</span>, str), exit(1);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Error(str) FatalError(str);</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AvlNode</span>;</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">AvlNode</span> *<span class="title">Position</span>;</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">AvlNode</span> *<span class="title">AvlTree</span>;</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> ElementType;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">AvlNode</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    ElementType Element;</span><br><span class="line">    AvlTree Left;</span><br><span class="line">    AvlTree Right;</span><br><span class="line">    <span class="keyword">int</span> Height;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">AvlTree</span><br><span class="line">MakeEmpty(AvlTree T);</span><br><span class="line"><span class="function">Position <span class="title">Find</span><span class="params">(ElementType X, AvlTree T)</span></span>;</span><br><span class="line"><span class="function">Position <span class="title">FindMin</span><span class="params">(AvlTree T)</span></span>;</span><br><span class="line"><span class="function">Position <span class="title">FindMax</span><span class="params">(AvlTree T)</span></span>;</span><br><span class="line"><span class="function">AvlTree <span class="title">Insert</span><span class="params">(ElementType X, AvlTree T)</span></span>;</span><br><span class="line"><span class="function">ElementType <span class="title">Retrieve</span><span class="params">(Position P)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">Height</span><span class="params">(Position P)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">Max</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">static</span> Position <span class="title">SingleRotateWithLeft</span><span class="params">(Position P)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">static</span> Position <span class="title">SingleRotateWithRight</span><span class="params">(Position P)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">static</span> Position <span class="title">DoubleRotateWithLeft</span><span class="params">(Position P)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">static</span> Position <span class="title">DoubleRotateWithRight</span><span class="params">(Position P)</span></span>;</span><br><span class="line"><span class="function">AvlTree <span class="title">Delete</span><span class="params">(Position P, AvlTree T)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printTree</span><span class="params">(AvlTree T)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">AvlTree <span class="title">MakeEmpty</span><span class="params">(AvlTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (T != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        MakeEmpty(T-&amp;gt;Left);</span><br><span class="line">        MakeEmpty(T-&amp;gt;Right);</span><br><span class="line">        <span class="built_in">free</span>(T);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ElementType <span class="title">Retrieve</span><span class="params">(Position P)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> P-&amp;gt;Element;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Position <span class="title">Find</span><span class="params">(ElementType X, AvlTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (T == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (X &amp;lt; T-&amp;gt;Element)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Find(X, T-&amp;gt;Left);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (X &amp;gt; T-&amp;gt;Element)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> Find(X, T-&amp;gt;Right);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> T;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Position <span class="title">FindMin</span><span class="params">(AvlTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (T == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (T-&amp;gt;Left == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> T;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> FindMin(T-&amp;gt;Left);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Position <span class="title">FindMax</span><span class="params">(AvlTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (T != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span> (T-&amp;gt;Right != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            T = T-&amp;gt;Right;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">Height</span><span class="params">(Position P)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (P == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> P-&amp;gt;Height;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">Max</span><span class="params">(<span class="keyword">int</span> height1, <span class="keyword">int</span> height2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (height1 &amp;gt; height2)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> height1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> height2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">AvlTree <span class="title">Insert</span><span class="params">(ElementType X, AvlTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (T == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        T = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct AvlNode));</span><br><span class="line">        <span class="keyword">if</span> (T == <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Error(<span class="string">"Error: out of space!!!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            T-&amp;gt;Element = X;</span><br><span class="line">            T-&amp;gt;Left = T-&amp;gt;Right = <span class="literal">NULL</span>;</span><br><span class="line">            T-&amp;gt;Height = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (X &amp;lt; T-&amp;gt;Element)</span><br><span class="line">    &#123;</span><br><span class="line">        T-&amp;gt;Left = Insert(X, T-&amp;gt;Left);</span><br><span class="line">        <span class="keyword">if</span> (Height(T-&amp;gt;Left) - Height(T-&amp;gt;Right) == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (X &amp;lt; T-&amp;gt;Left-&amp;gt;Element)</span><br><span class="line">            &#123;</span><br><span class="line">                T = SingleRotateWithLeft(T);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                T = DoubleRotateWithLeft(T);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        T-&amp;gt;Right = Insert(X, T-&amp;gt;Right);</span><br><span class="line">        <span class="keyword">if</span> (Height(T-&amp;gt;Right) - Height(T-&amp;gt;Left) == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (X &amp;gt; T-&amp;gt;Right-&amp;gt;Element)</span><br><span class="line">            &#123;</span><br><span class="line">                T = SingleRotateWithRight(T);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                T = DoubleRotateWithRight(T);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    T-&amp;gt;Height = Max(Height(T-&amp;gt;Left), Height(T-&amp;gt;Right)) + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å·¦å•æ—‹</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> Position <span class="title">SingleRotateWithLeft</span><span class="params">(Position P)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Position K1;</span><br><span class="line">    K1 = P-&amp;gt;Left;</span><br><span class="line">    P-&amp;gt;Left = K1-&amp;gt;Right;</span><br><span class="line">    K1-&amp;gt;Right = P;</span><br><span class="line"></span><br><span class="line">    P-&amp;gt;Height = Max(Height(P-&amp;gt;Left), Height(P-&amp;gt;Right)) + <span class="number">1</span>;</span><br><span class="line">    K1-&amp;gt;Height = Max(Height(K1-&amp;gt;Left), P-&amp;gt;Height) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> K1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å³å•æ—‹</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> Position <span class="title">SingleRotateWithRight</span><span class="params">(Position P)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Position K1;</span><br><span class="line">    K1 = P-&amp;gt;Right;</span><br><span class="line">    P-&amp;gt;Right = K1-&amp;gt;Left;</span><br><span class="line">    K1-&amp;gt;Left = P;</span><br><span class="line"></span><br><span class="line">    P-&amp;gt;Height = Max(Height(P-&amp;gt;Left), Height(P-&amp;gt;Right)) + <span class="number">1</span>;</span><br><span class="line">    K1-&amp;gt;Height = Max(Height(K1-&amp;gt;Left), P-&amp;gt;Height) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> K1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å·¦åŒæ—‹</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> Position <span class="title">DoubleRotateWithLeft</span><span class="params">(Position P)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    P-&amp;gt;Left = SingleRotateWithRight(P-&amp;gt;Left);</span><br><span class="line">    <span class="keyword">return</span> SingleRotateWithLeft(P);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å³åŒæ—‹</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> Position <span class="title">DoubleRotateWithRight</span><span class="params">(Position P)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    P-&amp;gt;Right = SingleRotateWithLeft(P-&amp;gt;Right);</span><br><span class="line">    <span class="keyword">return</span> SingleRotateWithRight(P);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ é™¤</span></span><br><span class="line"><span class="function">AvlTree <span class="title">Delete</span><span class="params">(Position P, AvlTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Position PMix;</span><br><span class="line">    Position Tmp;</span><br><span class="line">    <span class="keyword">if</span> (T != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (T-&amp;gt;Element &amp;gt; P-&amp;gt;Element)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// printf("34\n");</span></span><br><span class="line">            T-&amp;gt;Left = Delete(P, T-&amp;gt;Left);</span><br><span class="line">            T-&amp;gt;Height = Max(Height(T-&amp;gt;Right), Height(T-&amp;gt;Left)) + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (Height(T-&amp;gt;Right) - Height(T-&amp;gt;Left) == <span class="number">2</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (T-&amp;gt;Right-&amp;gt;Element &amp;lt; P-&amp;gt;Element)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span>  SingleRotateWithRight(T);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> DoubleRotateWithRight(T);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (T-&amp;gt;Element &amp;lt; P-&amp;gt;Element)</span><br><span class="line">        &#123;</span><br><span class="line">            T-&amp;gt;Right = Delete(P, T-&amp;gt;Right);</span><br><span class="line"></span><br><span class="line">            T-&amp;gt;Height = Max(Height(T-&amp;gt;Right), Height(T-&amp;gt;Left)) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (Height(T-&amp;gt;Left) - Height(T-&amp;gt;Right) == <span class="number">2</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (T-&amp;gt;Left-&amp;gt;Element &amp;gt; P-&amp;gt;Element)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span> SingleRotateWithLeft(T);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">return</span>  DoubleRotateWithLeft(T);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (T-&amp;gt;Right != <span class="literal">NULL</span> &amp;amp;&amp;amp; T-&amp;gt;Left != <span class="literal">NULL</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (Height(T-&amp;gt;Right) &amp;gt; Height(T-&amp;gt;Left))</span><br><span class="line">                &#123;</span><br><span class="line">                    PMix = FindMin(T-&amp;gt;Right);</span><br><span class="line">                    T-&amp;gt;Element = PMix-&amp;gt;Element;</span><br><span class="line">                    T-&amp;gt;Right = Delete(PMix, T-&amp;gt;Right);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    PMix = FindMax(T-&amp;gt;Left);</span><br><span class="line">                    T-&amp;gt;Element = PMix-&amp;gt;Element;</span><br><span class="line">                    T-&amp;gt;Left = Delete(PMix, T-&amp;gt;Left);</span><br><span class="line">                &#125;</span><br><span class="line">                T-&amp;gt;Height = Max(Height(T-&amp;gt;Right), Height(T-&amp;gt;Left)) + <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                Tmp = P;</span><br><span class="line">                T = P-&amp;gt;Right ? P-&amp;gt;Right : P-&amp;gt;Left;</span><br><span class="line">                <span class="built_in">free</span>(Tmp);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">printTree</span><span class="params">(AvlTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (T != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        printTree(T-&amp;gt;Left);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d"</span>, T-&amp;gt;Element);</span><br><span class="line">        printTree(T-&amp;gt;Right);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,n;</span><br><span class="line">    AvlTree T;</span><br><span class="line">    Position P;</span><br><span class="line">    n = <span class="number">20</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &amp;lt; n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        T = Insert(i, T);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    printTree(T);</span><br><span class="line">    P = Find(<span class="number">4</span>, T);</span><br><span class="line">    T = Delete(P, T);</span><br><span class="line"></span><br><span class="line">    P = Find(<span class="number">5</span>, T);</span><br><span class="line">    T = Delete(P, T);</span><br><span class="line"></span><br><span class="line">    P = Find(<span class="number">17</span>, T);</span><br><span class="line">    T = Delete(P, T);</span><br><span class="line"></span><br><span class="line">    T = Insert(<span class="number">5</span>, T);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    printTree(T);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"æ ¹èŠ‚ç‚¹çš„é«˜åº¦ï¼š%d\n"</span>, T-&amp;gt;Height);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"æ ¹èŠ‚ç‚¹çš„å€¼ï¼š%d\n"</span>,T-&amp;gt;Element);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    test();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      <categories>
          
          <category> ç®—æ³•æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AvlTree </tag>
            
            <tag> Avlå¹³è¡¡æ ‘ </tag>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³•åˆ†æ ä»è¯­è¨€æè¿° </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>python è™šæ‹Ÿç¯å¢ƒ virtualenv</title>
      <link href="/2017/08/23/python-e8-99-9a-e6-8b-9f-e7-8e-af-e5-a2-83-virtualenv/"/>
      <url>/2017/08/23/python-e8-99-9a-e6-8b-9f-e7-8e-af-e5-a2-83-virtualenv/</url>
      <content type="html"><![CDATA[<h4 id="ï¼ˆå†…å®¹æ¥è‡ªç½‘ç»œï¼Œå¤‡ç”¨ï¼‰"><a href="#ï¼ˆå†…å®¹æ¥è‡ªç½‘ç»œï¼Œå¤‡ç”¨ï¼‰" class="headerlink" title="ï¼ˆå†…å®¹æ¥è‡ªç½‘ç»œï¼Œå¤‡ç”¨ï¼‰"></a>ï¼ˆå†…å®¹æ¥è‡ªç½‘ç»œï¼Œå¤‡ç”¨ï¼‰</h4><p><a href="http://pypi.python.org/pypi/virtualenv" target="_blank" rel="noopener">virtualenv</a> æ˜¯ä¸€ä¸ªåˆ›å»ºéš”ç»çš„Pythonç¯å¢ƒçš„ å·¥å…·ã€‚virtualenvåˆ›å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰å¿…è¦çš„å¯æ‰§è¡Œæ–‡ä»¶çš„æ–‡ä»¶å¤¹ï¼Œç”¨æ¥ä½¿ç”¨Pythonå·¥ç¨‹æ‰€éœ€çš„åŒ…ã€‚<br>é€šè¿‡pipå®‰è£…virtualenvï¼š<br>$ <code>pip install virtualenv</code></p><p>æµ‹è¯•ä½ çš„å®‰è£…<br>$ <code>virtualenv --version</code></p><p>åŸºæœ¬ä½¿ç”¨<a href="http://pythonguidecn.readthedocs.io/zh/latest/dev/virtualenvs.html#id3" target="_blank" rel="noopener"></a><br>ä¸ºä¸€ä¸ªå·¥ç¨‹åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼š</p><p>$ cd <code>my_project_folder$ virtualenv my_project</code></p><p>virtualenv my_project<br> å°†ä¼šåœ¨å½“å‰çš„ç›®å½•ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼ŒåŒ…å«äº†Pythonå¯æ‰§è¡Œæ–‡ä»¶ï¼Œ ä»¥åŠ pip<br> åº“çš„ä¸€ä»½æ‹·è´ï¼Œè¿™æ ·å°±èƒ½å®‰è£…å…¶ä»–åŒ…äº†ã€‚è™šæ‹Ÿç¯å¢ƒçš„åå­—ï¼ˆæ­¤ä¾‹ä¸­æ˜¯ my_project<br> ï¼‰ å¯ä»¥æ˜¯ä»»æ„çš„ï¼›è‹¥çœç•¥åå­—å°†ä¼šæŠŠæ–‡ä»¶å‡æ”¾åœ¨å½“å‰ç›®å½•ã€‚<br>åœ¨ä»»ä½•ä½ è¿è¡Œå‘½ä»¤çš„ç›®å½•ä¸­ï¼Œè¿™ä¼šåˆ›å»ºPythonçš„æ‹·è´ï¼Œå¹¶å°†ä¹‹æ”¾åœ¨å«åš my_project<br> çš„æ–‡ä»¶ä¸­ã€‚<br>ä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨ä¸€ä¸ªPythonè§£é‡Šå™¨ï¼ˆæ¯”å¦‚<code>python2.7</code>ï¼‰ï¼š<br>$ <code>virtualenv -p /usr/bin/python2.7 my_project</code></p><p>æˆ–è€…ä½¿ç”¨<code>~/.bashrc</code>çš„ä¸€ä¸ªç¯å¢ƒå˜é‡å°†è§£é‡Šå™¨æ”¹ä¸ºå…¨å±€æ€§çš„ï¼š<br>$ <code>export VIRTUALENVWRAPPER_PYTHON=/usr/bin/python2.7</code></p><p>è¦å¼€å§‹ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒï¼Œå…¶éœ€è¦è¢«æ¿€æ´»ï¼š</p><p>$ <code>source my_project/bin/activate</code></p><p>å½“å‰è™šæ‹Ÿç¯å¢ƒçš„åå­—ä¼šæ˜¾ç¤ºåœ¨æç¤ºç¬¦å·¦ä¾§ï¼ˆæ¯”å¦‚è¯´ (my_project)ä½ çš„ç”µè„‘:ä½ çš„å·¥ç¨‹ ç”¨æˆ·å$ï¼‰ ä»¥è®©ä½ çŸ¥é“å®ƒæ˜¯æ¿€æ´»çš„ã€‚ä»ç°åœ¨èµ·ï¼Œä»»ä½•ä½ ä½¿ç”¨pipå®‰è£…çš„åŒ…å°†ä¼šæ”¾åœ¨ <code></code>my_project<br>æ–‡ä»¶å¤¹ä¸­ï¼Œ ä¸å…¨å±€å®‰è£…çš„Pythonéš”ç»å¼€ã€‚<br>åƒå¹³å¸¸ä¸€æ ·å®‰è£…åŒ…ï¼Œæ¯”å¦‚ï¼š<br>$ <code>pip install requests</code></p><p>å¦‚æœä½ åœ¨è™šæ‹Ÿç¯å¢ƒä¸­æš‚æ—¶å®Œæˆäº†å·¥ä½œï¼Œåˆ™å¯ä»¥åœç”¨å®ƒï¼š</p><p>$ <code>deactivate</code></p><p>è¿™å°†ä¼šå›åˆ°ç³»ç»Ÿé»˜è®¤çš„Pythonè§£é‡Šå™¨ï¼ŒåŒ…æ‹¬å·²å®‰è£…çš„åº“ä¹Ÿä¼šå›åˆ°é»˜è®¤çš„ã€‚<br>è¦åˆ é™¤ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒï¼Œåªéœ€åˆ é™¤å®ƒçš„æ–‡ä»¶å¤¹ã€‚ï¼ˆè¦è¿™ä¹ˆåšè¯·æ‰§è¡Œ rm -rf my_project<br> ï¼‰<br>ç„¶åä¸€æ®µæ—¶é—´åï¼Œä½ å¯èƒ½ä¼šæœ‰å¾ˆå¤šä¸ªè™šæ‹Ÿç¯å¢ƒæ•£è½åœ¨ç³»ç»Ÿå„å¤„ï¼Œä½ å°†æœ‰å¯èƒ½å¿˜è®°å®ƒä»¬çš„åå­—æˆ–è€…ä½ç½®ã€‚</p><p>å…¶ä»–æ³¨æ„<a href="http://pythonguidecn.readthedocs.io/zh/latest/dev/virtualenvs.html#id4" target="_blank" rel="noopener"></a><br>è¿è¡Œå¸¦ â€“no-site-packages<br> é€‰é¡¹çš„ virtualenv<br> å°†ä¸ä¼šåŒ…æ‹¬å…¨å±€å®‰è£…çš„åŒ…ã€‚ è¿™å¯ç”¨äºä¿æŒåŒ…åˆ—è¡¨å¹²å‡€ï¼Œä»¥é˜²ä»¥åéœ€è¦è®¿é—®å®ƒã€‚ï¼ˆè¿™åœ¨ virtualenv<br> 1.7åŠä¹‹åæ˜¯é»˜è®¤è¡Œä¸ºï¼‰<br>ä¸ºäº†ä¿æŒä½ çš„ç¯å¢ƒçš„ä¸€è‡´æ€§ï¼Œâ€œå†·å†»ä½ï¼ˆfreezeï¼‰â€ç¯å¢ƒåŒ…å½“å‰çš„çŠ¶æ€æ˜¯ä¸ªå¥½ä¸»æ„ã€‚è¦è¿™ä¹ˆåšï¼Œè¯·è¿è¡Œï¼š<br>$ <code>pip freeze &amp;gt; requirements.txt</code></p><p>è¿™å°†ä¼šåˆ›å»ºä¸€ä¸ª requirements.txt<br> æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†å½“å‰ç¯å¢ƒä¸­æ‰€æœ‰åŒ…åŠ å„è‡ªçš„ç‰ˆæœ¬çš„ç®€å•åˆ—è¡¨ã€‚ä½ å¯ä»¥ä½¿ç”¨ â€œpip listâ€åœ¨ä¸äº§ç”Ÿrequirementsæ–‡ä»¶çš„æƒ…å†µä¸‹ï¼Œ æŸ¥çœ‹å·²å®‰è£…åŒ…çš„åˆ—è¡¨ã€‚è¿™å°†ä¼šä½¿å¦ä¸€ä¸ªä¸åŒçš„å¼€å‘è€…ï¼ˆæˆ–è€…æ˜¯ä½ ï¼Œå¦‚æœä½ éœ€è¦é‡æ–°åˆ›å»ºè¿™æ ·çš„ç¯å¢ƒï¼‰ åœ¨ä»¥åå®‰è£…ç›¸åŒç‰ˆæœ¬çš„ç›¸åŒåŒ…å˜å¾—å®¹æ˜“ã€‚<br>$ <code>pip install -r requirements.txt</code></p><p>è¿™èƒ½å¸®åŠ©ç¡®ä¿å®‰è£…ã€éƒ¨ç½²å’Œå¼€å‘è€…ä¹‹é—´çš„ä¸€è‡´æ€§ã€‚<br>æœ€åï¼Œè®°ä½åœ¨æºç ç‰ˆæœ¬æ§åˆ¶ä¸­æ’é™¤æ‰è™šæ‹Ÿç¯å¢ƒæ–‡ä»¶å¤¹ï¼Œå¯åœ¨ignoreçš„åˆ—è¡¨ä¸­åŠ ä¸Šå®ƒã€‚</p>]]></content>
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pip </tag>
            
            <tag> python </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>pip æº</title>
      <link href="/2017/08/23/pip-e6-ba-90/"/>
      <url>/2017/08/23/pip-e6-ba-90/</url>
      <content type="html"><![CDATA[<p>é˜¿é‡Œ</p><blockquote><p><a href="http://mirrors.aliyun.com/pypi/simple" target="_blank" rel="noopener">http://mirrors.aliyun.com/pypi/simple</a></p></blockquote>]]></content>
      
      <categories>
          
          <category> python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> pip </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>åˆ†æLaravelé˜Ÿåˆ—å®ç°åŸç†è§£å†³é—®é¢˜</title>
      <link href="/2017/08/19/laravel-e9-98-9f-e5-88-97-e4-bd-bf-e7-94-a8-e4-b8-ad-e7-9a-84-e9-97-ae-e9-a2-98-e8-a7-a3-e5-86-b3-e8-ae-b0-e5-bd-95/"/>
      <url>/2017/08/19/laravel-e9-98-9f-e5-88-97-e4-bd-bf-e7-94-a8-e4-b8-ad-e7-9a-84-e9-97-ae-e9-a2-98-e8-a7-a3-e5-86-b3-e8-ae-b0-e5-bd-95/</url>
      <content type="html"><![CDATA[<h4 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h4><p>å…¬å¸é¡¹ç›®ä½¿ç”¨Laravelçš„å¼€å‘çš„ä¸¤ä¸ªé¡¹ç›®åœ¨åŒä¸€ä¸ªæµ‹è¯•æœåŠ¡å™¨éƒ¨ç½²ï¼Œå…¬ç”¨åŒä¸€ä¸ªredisã€‚åœ¨ä½¿ç”¨laravelä¸­çš„é˜Ÿåˆ—æ—¶ï¼Œäº§ç”Ÿå†²çªå¹²æ‰°ã€‚</p><h4 id="æŸ¥æ‰¾é—®é¢˜åŸå› "><a href="#æŸ¥æ‰¾é—®é¢˜åŸå› " class="headerlink" title="æŸ¥æ‰¾é—®é¢˜åŸå› "></a>æŸ¥æ‰¾é—®é¢˜åŸå› </h4><p>åœ¨laravel é˜Ÿåˆ—çš„æ“ä½œç±»<code>Illuminate\Queue\RedisQueue.php</code>ä¸­å¯ä»¥çœ‹åˆ°<code>pushRaw()</code>æ–¹æ³•ï¼š</p><pre><code>// å°†ä¸€ä»»åŠ¡æ¨å…¥é˜Ÿåˆ—ä¸­public function pushRaw($payload, $queue = null, array $options = [])    {        $this-&amp;gt;getConnection()-&amp;gt;rpush($this-&amp;gt;getQueue($queue), $payload);        return Arr::get(json_decode($payload, true), &apos;id&apos;);    }`&lt;/pre&gt;ä»è¯¥æ–¹æ³•ä¸­å¯ä»¥çœ‹å‡ºLrarvelé˜Ÿåˆ—çš„rediså®ç°æ˜¯é€šè¿‡listç»“æ„å®ç°çš„ï¼Œ`rpush(key, value)`æ˜¯å°†valueæ¨å…¥é”®å€¼ä¸ºkeyçš„redisé˜Ÿåˆ—ï¼Œkeyçš„å€¼åˆ™æ˜¯é€šè¿‡`$this-&amp;gt;getQueue($queue)` è·å–åˆ°çš„&lt;pre class=&quot;line-numbers prism-highlight&quot; data-start=&quot;1&quot;&gt;`protected function getQueue($queue)    {        return &apos;queues:&apos;.($queue ?: $this-&amp;gt;default);    }`&lt;/pre&gt;æ‰€ä»¥çš„redisä¸­listä¸­çš„keyæ˜¯ `&apos;queues:&apos;.($queue ?: $this-&amp;gt;default);`æ‹¼æ¥çš„ï¼Œ`$this-&amp;gt;default` çš„å€¼æ˜¯ `RedisQueue` å®ä¾‹åŒ–çš„æ—¶å€™ä»`config\queue.php`é…ç½®ä¸­åŠ è½½çš„ `&apos;queue&apos;      =&amp;gt; &apos;default&apos;`ï¼Œ`$queue` æ˜¯æ·»åŠ é˜Ÿåˆ—æ—¶`$this-&amp;gt;dispatch( new jobClass()-&amp;gt;onQueue($queue) )`ä¼ å…¥çš„ã€‚&lt;pre class=&quot;line-numbers prism-highlight&quot; data-start=&quot;1&quot;&gt;`// config\queue.php æ–‡ä»¶ä¸­çš„redisé…ç½®éƒ¨åˆ†&apos;redis&apos; =&amp;gt; [            &apos;driver&apos;     =&amp;gt; &apos;redis&apos;,            &apos;connection&apos; =&amp;gt; &apos;default&apos;,            &apos;queue&apos;      =&amp;gt; &apos;default&apos;,            &apos;expire&apos;     =&amp;gt; 60,        ],`&lt;/pre&gt;è‡³æ­¤ï¼Œä¸¤ä¸ªé¡¹ç›®çš„é˜Ÿåˆ—å†²çªåŸå› å°±æ‰¾åˆ°äº†ã€‚å› ä¸ºredisé˜Ÿåˆ—é…ç½®ä¸­ `&apos;queue&apos;      =&amp;gt; &apos;default&apos;` éƒ½ä½¿ç”¨çš„é»˜è®¤çš„defaultï¼Œæ‰€ä»¥å½“å…±ç”¨redisæ—¶ï¼Œé»˜è®¤çš„é˜Ÿåˆ—list éƒ½æ˜¯&apos;queue:default&apos;,æ‰€ä»¥å¯¼è‡´äº†å†²çªã€‚å› ä¸ºé˜Ÿåˆ—ç›‘å¬ ç›‘å¬çš„é˜Ÿåˆ—åç§°æ˜¯ç”± --queueå‚æ•°å†³å®šçš„ï¼Œå¦‚æœä¸ä¼ å°±æ˜¯æˆ‘ä»¬ä¸Šé¢è®¾ç½®çš„é»˜è®¤å€¼ï¼Œè‹¥ä¼ äº†å°±ä¼šæ ¹æ®ä¼ å…¥çš„é˜Ÿåˆ—åä»å‰å¾€åä¼˜å…ˆä¾æ¬¡å¤„ç†ï¼Œå…·ä½“è§ä»£ç `Illuminate\Queue\Worker.php`ä¸­ï¼š&lt;pre class=&quot;line-numbers prism-highlight&quot; data-start=&quot;1&quot;&gt;`protected function getNextJob($connection, $queue)    {        if (is_null($queue)) {            return $connection-&amp;gt;pop();        }        foreach (explode(&apos;,&apos;, $queue) as $queue) {            if (! is_null($job = $connection-&amp;gt;pop($queue))) {                return $job;            }        }    }`&lt;/pre&gt;`$queue`å°±æ˜¯`--queue=`ä¼ å…¥çš„å‚æ•°ï¼Œå½“ $queueä¸å­˜åœ¨æ˜¯ç›´æ¥è°ƒç”¨`$connection-&amp;gt;pop()`å½“å‚æ•°å­˜åœ¨æ—¶ä¼šå°†å‚æ•°è§£æï¼Œä¼˜å…ˆå¤„ç†æ’åœ¨å‰é¢çš„é˜Ÿåˆ—åç§°ï¼Œå°†é˜Ÿåˆ—åç§°ä¼ å…¥`pop($queue)`, `pop()`ä¼šå°è¯•ä»æŒ‡å®šé˜Ÿåˆ—æˆ–é»˜è®¤é˜Ÿåˆ—ä¸­è·å–é˜Ÿåˆ—ä»»åŠ¡&lt;pre class=&quot;line-numbers prism-highlight&quot; data-start=&quot;1&quot;&gt;`// Illuminate\Queue\RedisQueue.phppublic function pop($queue = null)    {        $original = $queue ?: $this-&amp;gt;default;        $queue = $this-&amp;gt;getQueue($queue);        if (! is_null($this-&amp;gt;expire)) {            $this-&amp;gt;migrateAllExpiredJobs($queue);        }        $job = $this-&amp;gt;getConnection()-&amp;gt;lpop($queue);        if (! is_null($job)) {            $this-&amp;gt;getConnection()-&amp;gt;zadd($queue.&apos;:reserved&apos;, $this-&amp;gt;getTime() + $this-&amp;gt;expire, $job);            return new RedisJob($this-&amp;gt;container, $this, $job, $original);        }    }</code></pre><p>è‡³æ­¤ææ¸…äº†é˜Ÿåˆ—æ‰§è¡Œçš„åŸç†ã€‚</p><h4 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h4><p>å°†queueçš„é…ç½®æ–‡ä»¶ä¸­é»˜è®¤é˜Ÿåˆ—ä¿®æ”¹ä¸ºä¸åŒçš„åç§°ï¼Œæ¯”å¦‚ï¼š â€˜queueâ€™      =&gt; laravel1â€™,â€™queueâ€™      =&gt; laravel2â€™ã€‚</p><p>é˜Ÿåˆ—ç›‘å¬ <code>php artisan queue:listen redis --queue=laravel1,syncExpress</code></p><h4 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h4><p>é‡åˆ°é—®é¢˜ï¼Œè«è¦ç—…æ€¥ä¹±æŠ•åŒ»ã€‚ä»ä»£ç å…¥æ‰‹ï¼Œåˆ†æç†è§£å®ç°åŸç†ï¼Œæ‰¾å¯¹ç‚¹ï¼Œè§£å†³æ–¹æ³•ä¹Ÿè®¸å¾ˆç®€å•ï¼Œ^_^ã€‚</p><p>æ¬¢è¿å…³æ³¨æˆ‘çš„<a href="http://llheng.info" target="_blank" rel="noopener">åšå®¢</a></p>]]></content>
      
      <categories>
          
          <category> Laravel </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Laravel </tag>
            
            <tag> php </tag>
            
            <tag> queue </tag>
            
            <tag> é˜Ÿåˆ— </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>Go å„å¹³å°äº¤å‰ç¼–è¯‘</title>
      <link href="/2017/08/12/Go%20%E5%90%84%E5%B9%B3%E5%8F%B0%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91/"/>
      <url>/2017/08/12/Go%20%E5%90%84%E5%B9%B3%E5%8F%B0%E4%BA%A4%E5%8F%89%E7%BC%96%E8%AF%91/</url>
      <content type="html"><![CDATA[<h6 id="Golang-æ”¯æŒäº¤å‰ç¼–è¯‘ï¼Œåœ¨ä¸€ä¸ªå¹³å°ä¸Šç”Ÿæˆå¦ä¸€ä¸ªå¹³å°çš„å¯æ‰§è¡Œç¨‹åºï¼Œæœ€è¿‘ä½¿ç”¨äº†ä¸€ä¸‹ï¼Œéå¸¸å¥½ç”¨ï¼Œè¿™é‡Œå¤‡å¿˜ä¸€ä¸‹ã€‚"><a href="#Golang-æ”¯æŒäº¤å‰ç¼–è¯‘ï¼Œåœ¨ä¸€ä¸ªå¹³å°ä¸Šç”Ÿæˆå¦ä¸€ä¸ªå¹³å°çš„å¯æ‰§è¡Œç¨‹åºï¼Œæœ€è¿‘ä½¿ç”¨äº†ä¸€ä¸‹ï¼Œéå¸¸å¥½ç”¨ï¼Œè¿™é‡Œå¤‡å¿˜ä¸€ä¸‹ã€‚" class="headerlink" title="Golang æ”¯æŒäº¤å‰ç¼–è¯‘ï¼Œåœ¨ä¸€ä¸ªå¹³å°ä¸Šç”Ÿæˆå¦ä¸€ä¸ªå¹³å°çš„å¯æ‰§è¡Œç¨‹åºï¼Œæœ€è¿‘ä½¿ç”¨äº†ä¸€ä¸‹ï¼Œéå¸¸å¥½ç”¨ï¼Œè¿™é‡Œå¤‡å¿˜ä¸€ä¸‹ã€‚"></a>Golang æ”¯æŒäº¤å‰ç¼–è¯‘ï¼Œåœ¨ä¸€ä¸ªå¹³å°ä¸Šç”Ÿæˆå¦ä¸€ä¸ªå¹³å°çš„å¯æ‰§è¡Œç¨‹åºï¼Œæœ€è¿‘ä½¿ç”¨äº†ä¸€ä¸‹ï¼Œéå¸¸å¥½ç”¨ï¼Œè¿™é‡Œå¤‡å¿˜ä¸€ä¸‹ã€‚</h6><p>Mac ä¸‹ç¼–è¯‘ <a href="http://lib.csdn.net/base/linux" target="_blank" rel="noopener">Linux</a> å’Œ Windows 64ä½å¯æ‰§è¡Œç¨‹åº</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CGO_ENABLED=<span class="number">0</span> GOOS=linux GOARCH=amd64 <span class="keyword">go</span> build </span><br><span class="line">CGO_ENABLED=<span class="number">0</span> GOOS=windows GOARCH=amd64 <span class="keyword">go</span> build</span><br></pre></td></tr></table></figure><p><a href="http://lib.csdn.net/base/linux" target="_blank" rel="noopener">linux</a> ä¸‹ç¼–è¯‘ Mac å’Œ Windows 64ä½å¯æ‰§è¡Œç¨‹åº</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CGO_ENABLED=<span class="number">0</span> GOOS=darwin GOARCH=amd64 <span class="keyword">go</span> build </span><br><span class="line">CGO_ENABLED=<span class="number">0</span> GOOS=windows GOARCH=amd64 <span class="keyword">go</span> build</span><br></pre></td></tr></table></figure><p>Windows ä¸‹ç¼–è¯‘ Mac å’Œ Linux 64ä½å¯æ‰§è¡Œç¨‹åº</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SET CGO_ENABLED=<span class="number">0</span>SET GOOS=darwinSET GOARCH=amd64 <span class="keyword">go</span> build main.<span class="keyword">go</span></span><br><span class="line">SET CGO_ENABLED=<span class="number">0</span>SET GOOS=linuxSET GOARCH=amd64 <span class="keyword">go</span> build main.<span class="keyword">go</span></span><br></pre></td></tr></table></figure><blockquote><p>GOOSï¼šç›®æ ‡å¹³å°çš„<a href="http://lib.csdn.net/base/operatingsystem" target="_blank" rel="noopener">æ“ä½œç³»ç»Ÿ</a>ï¼ˆdarwinã€freebsdã€linuxã€windowsï¼‰ GOARCHï¼šç›®æ ‡å¹³å°çš„ä½“ç³»<a href="http://lib.csdn.net/base/architecture" target="_blank" rel="noopener">æ¶æ„</a>ï¼ˆ386ã€amd64ã€armï¼‰ äº¤å‰ç¼–è¯‘ä¸æ”¯æŒ CGO æ‰€ä»¥è¦ç¦ç”¨å®ƒ<br>  ä¸Šé¢çš„å‘½ä»¤ç¼–è¯‘ 64 ä½å¯æ‰§è¡Œç¨‹åºï¼Œä½ å½“ç„¶åº”è¯¥ä¹Ÿä¼šä½¿ç”¨ 386 ç¼–è¯‘ 32 ä½å¯æ‰§è¡Œç¨‹åº å¾ˆå¤šåšå®¢éƒ½æåˆ°è¦å…ˆå¢åŠ å¯¹å…¶å®ƒå¹³å°çš„æ”¯æŒï¼Œä½†æ˜¯æˆ‘è·³è¿‡é‚£ä¸€æ­¥ï¼Œä¸Šé¢æ‰€åˆ—çš„å‘½ä»¤ä¹Ÿéƒ½èƒ½æˆåŠŸï¼Œä¸”å¾—åˆ°æˆ‘æƒ³è¦çš„ç»“æœï¼Œå¯è§é‚£ä¸€æ­¥åº”è¯¥æ˜¯éå¿…é¡»çš„ï¼Œæˆ–æ˜¯æˆ‘æ‰€ä½¿ç”¨çš„ <a href="http://lib.csdn.net/base/go" target="_blank" rel="noopener">Go</a> ç‰ˆæœ¬å·²é»˜è®¤æ”¯æŒæ‰€æœ‰å¹³å°ã€‚</p></blockquote>]]></content>
      
      <categories>
          
          <category> go </category>
          
      </categories>
      
      
        <tags>
            
            <tag> build </tag>
            
            <tag> go </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>äºŒå‰æ ‘--Cè¯­è¨€å®ç°</title>
      <link href="/2017/07/20/%E4%BA%8C%E5%8F%89%E6%A0%91--C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0/"/>
      <url>/2017/07/20/%E4%BA%8C%E5%8F%89%E6%A0%91--C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0/</url>
      <content type="html"><![CDATA[<h3 id="æ•°æ®ç»“æ„ä¸ç®—æ³•åˆ†æ-ç¬”è®°"><a href="#æ•°æ®ç»“æ„ä¸ç®—æ³•åˆ†æ-ç¬”è®°" class="headerlink" title="æ•°æ®ç»“æ„ä¸ç®—æ³•åˆ†æ ç¬”è®°"></a>æ•°æ®ç»“æ„ä¸ç®—æ³•åˆ†æ ç¬”è®°</h3><h6 id="searchtree-c"><a href="#searchtree-c" class="headerlink" title="searchtree.c"></a>searchtree.c</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FatalError(str) fprintf(stderr, <span class="meta-string">"%s\n"</span>, str),exit(1);</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> Error(str) FatalError(str);</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span>;</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> *<span class="title">Position</span>;</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> *<span class="title">SearchTree</span>;</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> ElementType;</span><br><span class="line"></span><br><span class="line"><span class="function">SearchTree <span class="title">MakeEmpty</span><span class="params">(SearchTree T)</span></span>;</span><br><span class="line"><span class="function">Position <span class="title">Find</span><span class="params">(ElementType X, SearchTree T)</span></span>;</span><br><span class="line"><span class="function">Position <span class="title">FindMin</span><span class="params">(SearchTree)</span></span>;</span><br><span class="line"><span class="function">Position <span class="title">FindMax</span><span class="params">(SearchTree)</span></span>;</span><br><span class="line"><span class="function">SearchTree <span class="title">Insert</span><span class="params">(ElementType X, SearchTree T)</span></span>;</span><br><span class="line"><span class="function">SearchTree <span class="title">Delete</span><span class="params">(ElementType X, SearchTree T)</span></span>;</span><br><span class="line"><span class="function">ElementType <span class="title">Retrieve</span><span class="params">(Position P)</span></span>;</span><br><span class="line"><span class="function">ElementType <span class="title">DeleteMin</span><span class="params">(SearchTree T)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> &#123;</span></span><br><span class="line">    ElementType Element;</span><br><span class="line">    Position Left;</span><br><span class="line">    Position Right;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">SearchTree <span class="title">MakeEmpty</span><span class="params">(SearchTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T != <span class="literal">NULL</span>)&#123;</span><br><span class="line">        T-&amp;gt;Element = <span class="literal">NULL</span>;</span><br><span class="line">        MakeEmpty(T-&amp;gt;Left);</span><br><span class="line">        MakeEmpty(T-&amp;gt;Right);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Position <span class="title">Find</span><span class="params">(ElementType X, SearchTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T == <span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    <span class="keyword">if</span>(X &amp;lt; T-&amp;gt;Element)&#123;</span><br><span class="line">        <span class="keyword">return</span> Find(X, T-&amp;gt;Left);</span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    <span class="keyword">if</span>(X &amp;gt; T-&amp;gt;Element)&#123;</span><br><span class="line">        <span class="keyword">return</span> Find(X, T-&amp;gt;Right);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> T;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Position <span class="title">FindMin</span><span class="params">(SearchTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T == <span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span></span><br><span class="line">    <span class="keyword">if</span>(T-&amp;gt;Left == <span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> T;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> FindMin(T-&amp;gt;Left);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Position <span class="title">FindMax</span><span class="params">(SearchTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (T != <span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="keyword">while</span>(T-&amp;gt;Right != <span class="literal">NULL</span>)&#123;</span><br><span class="line">            T = T-&amp;gt;Right;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Position FindMax(SearchTree T)</span></span><br><span class="line"><span class="comment">// &#123;</span></span><br><span class="line"><span class="comment">//     if(T == NULL)&#123;</span></span><br><span class="line"><span class="comment">//         return NULL;</span></span><br><span class="line"><span class="comment">//     &#125;else</span></span><br><span class="line"><span class="comment">//     if(T-&amp;gt;Right == NULL)&#123;</span></span><br><span class="line"><span class="comment">//         return T;</span></span><br><span class="line"><span class="comment">//     &#125;else&#123;</span></span><br><span class="line"><span class="comment">//         return FindMax(T-&amp;gt;Right);</span></span><br><span class="line"><span class="comment">//     &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="function">SearchTree <span class="title">Insert</span><span class="params">(ElementType X, SearchTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        T = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct TreeNode));</span><br><span class="line">        <span class="keyword">if</span>( T == <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            FatalError(<span class="string">"Out of space!!!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            T-&amp;gt;Element = X;</span><br><span class="line">            T-&amp;gt;Left = T-&amp;gt;Right = <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">if</span>(X &amp;lt; T-&amp;gt;Element)</span><br><span class="line">    &#123;</span><br><span class="line">        T-&amp;gt;Left = Insert(X, T-&amp;gt;Left);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">if</span>(X &amp;gt; T-&amp;gt;Element)</span><br><span class="line">        T-&amp;gt;Right = Insert(X, T-&amp;gt;Right);</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ElementType <span class="title">Retrieve</span><span class="params">(Position P)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> P-&amp;gt;Element;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">SearchTree <span class="title">Delete</span><span class="params">(ElementType X, SearchTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Position P;</span><br><span class="line">    <span class="keyword">if</span>(T == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        Error(<span class="string">"Element not found"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    <span class="keyword">if</span>(X &amp;lt; T-&amp;gt;Element)</span><br><span class="line">    &#123;</span><br><span class="line">        T = T-&amp;gt;Left;</span><br><span class="line">        <span class="keyword">return</span> Delete(X, T);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    <span class="keyword">if</span>(X &amp;gt; T-&amp;gt;Element)</span><br><span class="line">    &#123;</span><br><span class="line">        T = T-&amp;gt;Right;</span><br><span class="line">        <span class="keyword">return</span> Delete(X, T);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">if</span>(T-&amp;gt;Left &amp;amp;&amp;amp; T-&amp;gt;Right)</span><br><span class="line">    &#123;</span><br><span class="line">        T-&amp;gt;Element = DeleteMin(T-&amp;gt;Right);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        P = T;</span><br><span class="line">        <span class="keyword">if</span>(T-&amp;gt;Left == <span class="literal">NULL</span>)</span><br><span class="line">            T = T-&amp;gt;Right;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">if</span>(T-&amp;gt;Right == <span class="literal">NULL</span>)</span><br><span class="line">            T = T-&amp;gt;Left;</span><br><span class="line">        <span class="built_in">free</span>(P);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> T;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ElementType <span class="title">DeleteMin</span><span class="params">(SearchTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Position P;</span><br><span class="line">    ElementType X;</span><br><span class="line">    P = FindMin(T);</span><br><span class="line">    X = P-&amp;gt;Element;</span><br><span class="line">    <span class="built_in">free</span>(P);</span><br><span class="line">    <span class="keyword">return</span> X;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PrintSearchTree</span><span class="params">(SearchTree T)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(T == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        Error(<span class="string">"Element not found"</span>);</span><br><span class="line">    &#125;  </span><br><span class="line">    <span class="keyword">if</span>(T-&amp;gt;Left == <span class="literal">NULL</span> &amp;amp;&amp;amp; T-&amp;gt;Right == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, T-&amp;gt;Element);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(T-&amp;gt;Left != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            PrintSearchTree(T-&amp;gt;Left);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, T-&amp;gt;Element);</span><br><span class="line">        <span class="keyword">if</span>(T-&amp;gt;Right != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            PrintSearchTree(T-&amp;gt;Right);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">SearchTreeTest</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    SearchTree T;</span><br><span class="line">    T = MakeEmpty(T);</span><br><span class="line">    T = Insert(<span class="number">1</span>,T);</span><br><span class="line">    T = Insert(<span class="number">3</span>,T);</span><br><span class="line">    T = Insert(<span class="number">2</span>,T);</span><br><span class="line">    T = Insert(<span class="number">6</span>,T);</span><br><span class="line">    T = Insert(<span class="number">4</span>,T);</span><br><span class="line">    PrintSearchTree(T);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">`&lt;/pre&gt;</span><br><span class="line"></span><br><span class="line">&gt; main.c</span><br><span class="line"></span><br><span class="line">&lt;pre <span class="class"><span class="keyword">class</span>="<span class="title">line</span>-<span class="title">numbers</span> <span class="title">prism</span>-<span class="title">highlight</span>" <span class="title">data</span>-<span class="title">start</span>="1"&gt;`#<span class="title">include</span> "<span class="title">searchtree</span>.<span class="title">c</span>"</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">int</span> <span class="title">main</span>(<span class="title">void</span>)</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    SearchTreeTest();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> c </category>
          
          <category> ç®—æ³•æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c </tag>
            
            <tag> äºŒå‰æ ‘ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•åˆ†æ-c ç»ƒä¹  3-2 ç­”æ¡ˆ</title>
      <link href="/2017/07/11/e6-95-b0-e6-8d-ae-e7-bb-93-e6-9e-84-e4-b8-8e-e7-ae-97-e6-b3-95-e7-bb-83-e4-b9-a0-3-2-e7-ad-94-e6-a1-88/"/>
      <url>/2017/07/11/e6-95-b0-e6-8d-ae-e7-bb-93-e6-9e-84-e4-b8-8e-e7-ae-97-e6-b3-95-e7-bb-83-e4-b9-a0-3-2-e7-ad-94-e6-a1-88/</url>
      <content type="html"><![CDATA[<pre><code>#include &quot;list.c&quot;#define FatalError(str) fprintf(stderr, &quot;%s\n&quot;, str),exit(1);void PrintLots(List L, List P){    Position Lnext,Pnext;    int n;    if(IsEmpty(L)){        FatalError(&quot;list is empty!!!&quot;);    }    n = 1;    Lnext = L;    Pnext = P;    while((Lnext = Advance(Lnext)) != NULL){        while((Pnext = Advance(Pnext)) != NULL){            if(n++ == Lnext-&amp;gt;Element){                printf(&quot;%d\n&quot;, Pnext-&amp;gt;Element);                break;            }        }        if(Lnext == NULL || Pnext == NULL){            return;        }    }}</code></pre>]]></content>
      
      <categories>
          
          <category> c </category>
          
          <category> ç®—æ³•æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æ•°æ®ç»“æ„ä¸ç®—æ³•åˆ†æ ä»è¯­è¨€æè¿° </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¹‹æ ˆ--Cè¯­è¨€ æ•°ç»„å®ç°</title>
      <link href="/2017/07/09/e6-95-b0-e6-8d-ae-e7-bb-93-e6-9e-84-e4-b9-8b-e6-a0-88-c-e8-af-ad-e8-a8-80-e6-95-b0-e7-bb-84-e5-ae-9e-e7-8e-b0/"/>
      <url>/2017/07/09/e6-95-b0-e6-8d-ae-e7-bb-93-e6-9e-84-e4-b9-8b-e6-a0-88-c-e8-af-ad-e8-a8-80-e6-95-b0-e7-bb-84-e5-ae-9e-e7-8e-b0/</url>
      <content type="html"><![CDATA[<pre><code>#include &amp;lt;stdlib.h&amp;gt;#include &amp;lt;stdio.h&amp;gt;#include &amp;lt;string.h&amp;gt;// æ ˆæ“ä½œæ•°ç»„å®ç°typedef int ElementType;struct StackRecord;typedef struct StackRecord *Stack;int IsEmpty(Stack S);int IsFull(Stack S);Stack CreateStack(int MaxElements);void DisposeStack(Stack S);void MakeEmpty(Stack S);void Push(ElementType X, Stack S);ElementType Top(Stack S);void Pop(Stack S);ElementType TopAndPop(Stack S);void _Test(void);#define EmptyTOS (-1)#define MinStackSize (5)#define Error(str) fprintf(stderr,&quot;%s/n&quot;, str),exit(1)struct StackRecord {    int Capacity;    int TopOfStack;    ElementType *Array;};// åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©ºint IsEmpty(Stack S){    return S-&amp;gt;TopOfStack == EmptyTOS;}// åˆ¤æ–­æ ˆæ˜¯å¦å·²æ»¡int IsFull(Stack S){    return S-&amp;gt; Capacity == S-&amp;gt;TopOfStack;}Stack CreateStack(int MaxElements){    Stack S;    if(MaxElements &amp;lt; MinStackSize){        Error(&quot;Stack size too small&quot;);    }    S = malloc(sizeof(struct StackRecord));    if(S == NULL){        Error(&quot;Out of space!!!&quot;);    }    S-&amp;gt;Array = malloc(sizeof(ElementType) * MaxElements);    if(S-&amp;gt;Array == NULL){        Error(&quot;Out of space!!!&quot;);    }    S-&amp;gt;Capacity = MaxElements;    MakeEmpty(S);    return S;}void MakeEmpty(Stack S){    S-&amp;gt;TopOfStack = EmptyTOS;}void DisposeStack(Stack S){    if(S == NULL){        free(S-&amp;gt;Array);        free(S);    }}void Push(ElementType X, Stack S){    if(IsFull(S)){        Error(&quot;full stack&quot;);    }else{        S-&amp;gt;Array[++S-&amp;gt;TopOfStack] = X;    }  }ElementType Top(Stack S){    if(!IsEmpty(S)){        return S-&amp;gt;Array[S-&amp;gt;TopOfStack];    }    Error(&quot;Empty Stack!!!&quot;);    return 0;}void Pop(Stack S){    if(IsEmpty(S)){        Error(&quot;Empty Stack&quot;);    }else{        S-&amp;gt;TopOfStack--;    }}ElementType TopAndPop(Stack S){    if(IsEmpty(S)){        Error(&quot;Empty stack&quot;);        return 0;    }else{        return S-&amp;gt;TopOfStack--;    }}void _Test(void){    int a, b, c;    Stack S;    a = 1;    b = 2;    c = 3;    S = CreateStack(10);    if(S == NULL){        Error(&quot;create stack err&quot;);    }    Push(a, S);    printf(&quot;%d\\n&quot;, Top(S));    Push(b, S);    printf(&quot;%d\\n&quot;, Top(S));    Pop(S);    printf(&quot;%d\\n&quot;, Top(S));    MakeEmpty(S);    Push(c, S);    printf(&quot;%d\\n&quot;, Top(S));}</code></pre>]]></content>
      
      <categories>
          
          <category> c </category>
          
          <category> ç®—æ³•æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c </tag>
            
            <tag> stack </tag>
            
            <tag> æ ˆ </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¹‹æ ˆ--Cå®ç°ç¬”è®°</title>
      <link href="/2017/07/05/e6-95-b0-e6-8d-ae-e7-bb-93-e6-9e-84-e4-b9-8b-e6-a0-88-c-e5-ae-9e-e7-8e-b0-e7-ac-94-e8-ae-b0/"/>
      <url>/2017/07/05/e6-95-b0-e6-8d-ae-e7-bb-93-e6-9e-84-e4-b9-8b-e6-a0-88-c-e5-ae-9e-e7-8e-b0-e7-ac-94-e8-ae-b0/</url>
      <content type="html"><![CDATA[<pre><code>#include &amp;lt;stdlib.h&amp;gt;#include &amp;lt;stdio.h&amp;gt;#define FatalError(str) fprintf(stderr, &quot;%s\\n&quot;, str),exit(1);#define Error(str) FatalError(str);#ifndef _stack_hstruct Node;typedef struct Node *PtrToNode;typedef PtrToNode Stack;typedef int ElementType;Stack CreateStack(void);int IsEmpty(Stack S);void MakeEmpty(Stack S);void Pop(Stack S);void Push(ElementType X, Stack S);ElementType Top(Stack S);void _Test(void);#endifstruct Node{    ElementType Element;    PtrToNode Next;};Stack CreateStack(void){    Stack S;    S = malloc(sizeof(struct Node));    if(S == NULL){        FatalError(&quot;Out of space!!!&quot;);    }    S-&amp;gt;Next = NULL;    return S;}int IsEmpty(Stack S){    return S-&amp;gt;Next == NULL;}void MakeEmpty(Stack S){    if(S == NULL){        Error(&quot;Must use CreateStack first&quot;);    }else{        while(!IsEmpty(S)){        Pop(S);        }    }}void Push(ElementType X, Stack S){    PtrToNode TmpCell;    TmpCell = malloc(sizeof(struct Node));    if(TmpCell == NULL){        FatalError(&quot;out of space!!!&quot;);    }else{        TmpCell-&amp;gt;Element = X;        TmpCell-&amp;gt;Next = S-&amp;gt;Next;        S-&amp;gt;Next = TmpCell;    }}ElementType Top(Stack S){    if(!IsEmpty(S)){        return S-&amp;gt;Next-&amp;gt;Element;    }    Error(&quot;stack empty!&quot;);    return 0;}void Pop(Stack S){    PtrToNode TmpCell;    if(IsEmpty(S)){        Error(&quot;stack empty!&quot;);    }else{        TmpCell = S-&amp;gt;Next;        S-&amp;gt;Next = S-&amp;gt;Next-&amp;gt;Next;        free(TmpCell);    }}void _Test(void){    int a, b, c;    Stack S;    a = 1;    b = 2;    c = 3;    S = CreateStack();    if(S == NULL){        FatalError(&quot;create stack err&quot;);    }    Push(a, S);    printf(&quot;%d\\n&quot;, Top(S));    Push(b, S);    printf(&quot;%d\\n&quot;, Top(S));    Pop(S);    printf(&quot;%d\\n&quot;, Top(S));    MakeEmpty(S);    Push(c, S);    printf(&quot;%d\\n&quot;, Top(S));}</code></pre>]]></content>
      
      <categories>
          
          <category> c </category>
          
          <category> ç®—æ³•æ•°æ®ç»“æ„ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c </tag>
            
            <tag> æ ˆï¼Œstack </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>å•é“¾è¡¨ç¬”è®°</title>
      <link href="/2017/07/02/%E5%8D%95%E9%93%BE%E8%A1%A8/"/>
      <url>/2017/07/02/%E5%8D%95%E9%93%BE%E8%A1%A8/</url>
      <content type="html"><![CDATA[<p>list.c</p><pre><code>#include &lt;stdio.h&gt;;#include &lt;stdlib.h&gt;;#define FatalError(str) fprintf(stderr, &quot;%s\n&quot;, str),exit(1);typedef int ElementType;#ifndef _list_Hstruct Node;typedef struct Node *PtrToNode;typedef PtrToNode List;typedef PtrToNode Position;List MakeEmpty(List L);int IsEmpty(List L);int IsLast(Position P, List L);Position Find(ElementType X, List L);void Delete(ElementType X, List L);Position FindPrevious(ElementType X, List L);void Insert(ElementType X, List L, Position P);void DeleteList(List L);Position Header(List L);Position First(List L);Position Advance(Position P);ElementType Retrieve(Position P);#endifstruct Node {    ElementType Element;    Position Next;};List MakeEmpty(List L){    if (L != NULL){        DeleteList(L);    }    L = malloc(sizeof(struct Node));    if(L == NULL){        FatalError(&quot;Out of space!!!&quot;);    }    L-&amp;gt;Next = NULL;    return L;}// æµ‹è¯•é“¾è¡¨æ˜¯å¦æ˜¯ç©ºé“¾è¡¨int IsEmpty(List L){    return L-&amp;gt;Next == NULL;}// æ£€æµ‹å½“å‰ä½ç½®æ˜¯å¦æ˜¯é“¾è¡¨çš„æœ«å°¾int IsLast(Position P, List L){    return P-&amp;gt;Next == NULL;}// æŸ¥æ‰¾é“¾è¡¨ä¸­ç¬¬ä¸€æ¬¡å‡ºç°Xçš„ä½ç½®Position Find(ElementType X, List L){    Position P;    P = L-&amp;gt;Next;    while(P != NULL &amp;amp;&amp;amp; P-&amp;gt;Element != X){        P = P-&amp;gt;Next;    }    return P;}Position FindPrevious(ElementType X, List L){    Position P;    P = L;    while(P-&amp;gt;Next != NULL &amp;amp;&amp;amp; P-&amp;gt;Next-&amp;gt;Element != X){        P = P-&amp;gt;Next;    }    return P;}void Delete(ElementType X, List L){    Position P, TmpCell;    P = FindPrevious(X, L);    if(!IsLast(P, L)){        TmpCell = P-&amp;gt;Next;        P-&amp;gt;Next = TmpCell-&amp;gt;Next;        free(TmpCell);    }}void Insert(ElementType X, List L, Position P){    Position TmpCell;    TmpCell = malloc(sizeof(struct Node));    if(TmpCell == NULL){        FatalError(&quot;Out of space!!!&quot;);    }    TmpCell-&amp;gt;Element = X;    TmpCell-&amp;gt;Next = P-&amp;gt;Next;    P-&amp;gt;Next = TmpCell;}void DeleteList(List L){    Position P, TmpCell;    P = L-&amp;gt;Next;    L-&amp;gt;Next = NULL;    while(P != NULL){        TmpCell = P-&amp;gt;Next;        free(P);        P = TmpCell;    }}Position Header(List L){    return L;}Position First(List L){    return L-&amp;gt;Next;}Position Advance(Position P){    return P-&amp;gt;Next;}ElementType Retrieve(Position P){    return P-&amp;gt;Element;}void PrintList(List L){    Position P = Header(L);    if(IsEmpty(L)){        FatalError(&quot;Empty List\n&quot;);    }else{        do{            P = Advance(P);            printf(&quot;%d &quot;, P-&amp;gt;Element);        }while(!IsLast(P, L));    }    printf(&quot;\n&quot;);}`&lt;/pre&gt;main.c&lt;pre class=&quot;line-numbers prism-highlight&quot; data-start=&quot;1&quot;&gt;`#include &quot;list.c&quot;int main(){    List L;    Position P;    L = MakeEmpty(NULL);    P = Header(L);    Insert(1, L, P);    PrintList(L);    P = Advance(P);    Insert(2, L, P);    PrintList(L);    Delete(1, L);    PrintList(L);    DeleteList(L);    PrintList(L);    return 0;}</code></pre>]]></content>
      
      <categories>
          
          <category> mysql </category>
          
      </categories>
      
      
    </entry>
    
    <entry>
      <title>è®°ä¸€æ¬¡ä½¿ç”¨ä¸ƒç‰›è·å–tokençš„é”™è¯¯</title>
      <link href="/2017/06/26/e8-ae-b0-e4-b8-80-e6-ac-a1-e4-bd-bf-e7-94-a8-e4-b8-83-e7-89-9b-e8-8e-b7-e5-8f-96token-e7-9a-84-e9-94-99-e8-af-af/"/>
      <url>/2017/06/26/e8-ae-b0-e4-b8-80-e6-ac-a1-e4-bd-bf-e7-94-a8-e4-b8-83-e7-89-9b-e8-8e-b7-e5-8f-96token-e7-9a-84-e9-94-99-e8-af-af/</url>
      <content type="html"><![CDATA[<p>æµ‹è¯•æœåŠ¡å™¨ä¸­çš„ç£ç›˜æ»¡äº†ï¼Œæ•´ç†åä½¿ç”¨ï¼Œå‘ç°ä¸ƒç‰›è·å–token å‡ºé”™</p><pre><code>array_key_exists() expects parameter 2 to be array, null given</code></pre><p>ç»è¿‡æ’æŸ¥å‘ç°ï¼Œä¸ƒç‰›ä¼šå°†ä»è‡ªå·±æœåŠ¡å™¨ä¸­é…ç½®ä¿¡æ¯ç¼“å­˜åœ¨æœåŠ¡å™¨çš„ä¸´æ—¶æ–‡ä»¶ä¸­ã€‚<br>å› ä¸ºæµ‹è¯•æœåŠ¡å™¨ç£ç›˜æ»¡äº†ï¼Œå¯¼è‡´ä¸ƒç‰›çš„SDKåœ¨åˆ›å»ºä¸´æ—¶æ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶åˆ›å»ºäº†ä½†å†…å®¹æ²¡æœ‰å†™å…¥ï¼Œè·å–ä¿¡æ¯æ—¶åˆ¤æ–­æ–‡ä»¶å­˜åœ¨ï¼Œé‡Œé¢ä¿¡æ¯ä¸ºç©ºï¼Œç»“æœå¯¼è‡´äº†ä¸Šé¢æŠ¥é”™</p><h4 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h4><p>åˆ é™¤äº†ä¸ƒç‰›ä¸´æ—¶æ–‡ <code>.qiniu_phpsdk_hostscache.json</code></p>]]></content>
      
      <categories>
          
          <category> php </category>
          
      </categories>
      
      
        <tags>
            
            <tag> php </tag>
            
            <tag> ä¸ƒç‰› </tag>
            
            <tag> é”™è¯¯å¤„ç† </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>mac brewå¸¸ç”¨ä½¿ç”¨æ–¹æ³•</title>
      <link href="/2017/06/25/mac-brew-e5-b8-b8-e7-94-a8-e4-bd-bf-e7-94-a8-e6-96-b9-e6-b3-95/"/>
      <url>/2017/06/25/mac-brew-e5-b8-b8-e7-94-a8-e4-bd-bf-e7-94-a8-e6-96-b9-e6-b3-95/</url>
      <content type="html"><![CDATA[<p>æœç´¢ï¼š <code>brew search mysql</code></p><p>æŸ¥è¯¢ï¼š<code>brew info mysql</code> ä¸»è¦çœ‹å…·ä½“çš„ä¿¡æ¯ï¼Œæ¯”å¦‚ç›®å‰çš„ç‰ˆæœ¬ï¼Œä¾èµ–ï¼Œå®‰è£…åæ³¨æ„äº‹é¡¹ç­‰</p><p>æ›´æ–°ï¼š<code>brew update</code> è¿™ä¼šæ›´æ–° Homebrew è‡ªå·±ï¼Œå¹¶ä¸”ä½¿å¾—æ¥ä¸‹æ¥çš„ä¸¤ä¸ªæ“ä½œæœ‰æ„ä¹‰â€”â€”</p><p>æ£€æŸ¥è¿‡æ—¶ï¼ˆæ˜¯å¦æœ‰æ–°ç‰ˆæœ¬ï¼‰ï¼š<code>brew outdated</code> è¿™å›åˆ—å‡ºæ‰€æœ‰å®‰è£…çš„è½¯ä»¶é‡Œå¯ä»¥å‡çº§çš„é‚£äº›</p><p>å‡çº§ï¼š<code>brew upgrade</code> å‡çº§æ‰€æœ‰å¯ä»¥å‡çº§çš„è½¯ä»¶ä»¬</p><p>æ¸…ç†ï¼š<code>brew cleanup</code> æ¸…ç†ä¸éœ€è¦çš„ç‰ˆæœ¬æå…¶å®‰è£…åŒ…ç¼“å­˜</p><p>å¸è½½æ›´æ–¹ä¾¿äº†  <code>brew uninstall</code></p>]]></content>
      
      <categories>
          
          <category> ç³»ç»Ÿ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> brew </tag>
            
            <tag> mac </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ã€cè¯­è¨€ã€‘åˆ¤æ–­ä¸¤ä¸ªæ–‡ä»¶æ˜¯å¦ä¸€è‡´</title>
      <link href="/2017/06/19/c%E8%AF%AD%E8%A8%80-%E5%88%A4%E6%96%AD%E4%B8%A4%E4%B8%AA%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E4%B8%80%E8%87%B4/"/>
      <url>/2017/06/19/c%E8%AF%AD%E8%A8%80-%E5%88%A4%E6%96%AD%E4%B8%A4%E4%B8%AA%E6%96%87%E4%BB%B6%E6%98%AF%E5%90%A6%E4%B8%80%E8%87%B4/</url>
      <content type="html"><![CDATA[<h4 id="å­¦ä¹ ç¬”è®°"><a href="#å­¦ä¹ ç¬”è®°" class="headerlink" title="å­¦ä¹ ç¬”è®°"></a>å­¦ä¹ ç¬”è®°</h4><h6 id="åˆ¤æ–­ä¸¤ä¸ªæ–‡ä»¶æ˜¯å¦ä¸€è‡´-å¹¶æ‰“å°å‡ºç¬¬ä¸€ä¸ªä¸åŒè¡Œ"><a href="#åˆ¤æ–­ä¸¤ä¸ªæ–‡ä»¶æ˜¯å¦ä¸€è‡´-å¹¶æ‰“å°å‡ºç¬¬ä¸€ä¸ªä¸åŒè¡Œ" class="headerlink" title="åˆ¤æ–­ä¸¤ä¸ªæ–‡ä»¶æ˜¯å¦ä¸€è‡´ å¹¶æ‰“å°å‡ºç¬¬ä¸€ä¸ªä¸åŒè¡Œ"></a>åˆ¤æ–­ä¸¤ä¸ªæ–‡ä»¶æ˜¯å¦ä¸€è‡´ å¹¶æ‰“å°å‡ºç¬¬ä¸€ä¸ªä¸åŒè¡Œ</h6><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXLINE 100</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">diff</span><span class="params">(<span class="keyword">char</span> *a, <span class="keyword">char</span> *b)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="number">3</span> != argc)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"å‚æ•°ä¸æ­£ç¡®\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    diff(argv[<span class="number">1</span>], argv[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">diff</span><span class="params">(<span class="keyword">char</span> *a, <span class="keyword">char</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    FILE *afp;</span><br><span class="line">    FILE *bfp;</span><br><span class="line">    <span class="keyword">char</span> aline[MAXLINE];</span><br><span class="line">    <span class="keyword">char</span> bline[MAXLINE];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>((afp = fopen(a, <span class="string">"r"</span>)) == <span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Error: not file %s"</span>, a);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>((bfp = fopen(b, <span class="string">"r"</span>)) == <span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Error: not file %s"</span>, b);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>((fgets(aline, MAXLINE, afp) == aline) &amp;amp;&amp;amp; (fgets(bline, MAXLINE, bfp) == bline))&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">strcmp</span>(aline, bline) != <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%s:%s"</span>, a, aline);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"%s:%s"</span>, b, bline);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    fclose(afp);</span><br><span class="line">    fclose(bfp);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      <categories>
          
          <category> c </category>
          
      </categories>
      
      
        <tags>
            
            <tag> c </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>ã€mysqlã€‘ order by case when çš„ç”¨æ³•</title>
      <link href="/2017/06/18/order%20by%20case%20when%20%E7%9A%84%E7%94%A8%E6%B3%95/"/>
      <url>/2017/06/18/order%20by%20case%20when%20%E7%9A%84%E7%94%A8%E6%B3%95/</url>
      <content type="html"><![CDATA[<pre><code>select * from table order by case field when field=2 then 1 else 0 end, field desc;</code></pre><h3 id="ã€è§£é‡Šã€‘æŸ¥è¯¢æ—¶ï¼Œå½“æŸæ¡æ•°æ®ä¸­çš„å­—æ®µfield-çš„å€¼ä¸º2æ—¶ï¼Œè¯¥æ¡fieldçš„æ’åºæƒå€¼ä¸º1ï¼Œå…¶ä»–çš„ä¸º0ï¼Œä½¿ç”¨é™åºæ’åˆ—ï¼›"><a href="#ã€è§£é‡Šã€‘æŸ¥è¯¢æ—¶ï¼Œå½“æŸæ¡æ•°æ®ä¸­çš„å­—æ®µfield-çš„å€¼ä¸º2æ—¶ï¼Œè¯¥æ¡fieldçš„æ’åºæƒå€¼ä¸º1ï¼Œå…¶ä»–çš„ä¸º0ï¼Œä½¿ç”¨é™åºæ’åˆ—ï¼›" class="headerlink" title="ã€è§£é‡Šã€‘æŸ¥è¯¢æ—¶ï¼Œå½“æŸæ¡æ•°æ®ä¸­çš„å­—æ®µfield çš„å€¼ä¸º2æ—¶ï¼Œè¯¥æ¡fieldçš„æ’åºæƒå€¼ä¸º1ï¼Œå…¶ä»–çš„ä¸º0ï¼Œä½¿ç”¨é™åºæ’åˆ—ï¼›"></a>ã€è§£é‡Šã€‘æŸ¥è¯¢æ—¶ï¼Œå½“æŸæ¡æ•°æ®ä¸­çš„å­—æ®µfield çš„å€¼ä¸º2æ—¶ï¼Œè¯¥æ¡fieldçš„æ’åºæƒå€¼ä¸º1ï¼Œå…¶ä»–çš„ä¸º0ï¼Œä½¿ç”¨é™åºæ’åˆ—ï¼›</h3>]]></content>
      
      <categories>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    <entry>
      <title>LaravelæœåŠ¡å®¹å™¨å®ç°åŸç†</title>
      <link href="/2017/06/17/Laravel%E6%9C%8D%E5%8A%A1%E5%AE%B9%E5%99%A8%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/"/>
      <url>/2017/06/17/Laravel%E6%9C%8D%E5%8A%A1%E5%AE%B9%E5%99%A8%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/</url>
      <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>é€šè¿‡å®ç°laravel æ¡†æ¶åŠŸèƒ½ï¼Œä»¥ä¾¿æ·±å…¥ç†è§£laravelæ¡†æ¶çš„å…ˆè¿›æ€æƒ³ã€‚</p><h4 id="ä»€ä¹ˆæ˜¯æœåŠ¡å®¹å™¨"><a href="#ä»€ä¹ˆæ˜¯æœåŠ¡å®¹å™¨" class="headerlink" title="ä»€ä¹ˆæ˜¯æœåŠ¡å®¹å™¨"></a>ä»€ä¹ˆæ˜¯æœåŠ¡å®¹å™¨</h4><blockquote><p>æœåŠ¡å®¹å™¨æ˜¯ç”¨æ¥ç®¡ç†ç±»ä¾èµ–ä¸è¿è¡Œä¾èµ–æ³¨å…¥çš„å·¥å…·ã€‚Laravelæ¡†æ¶ä¸­å°±æ˜¯ä½¿ç”¨æœåŠ¡å®¹å™¨æ¥å®ç° <strong>æ§åˆ¶åè½¬</strong>å’Œ<strong>ä¾èµ–æ³¨å…¥</strong>ã€‚</p></blockquote><h4 id="ä»€ä¹ˆæ˜¯æ§åˆ¶åè½¬ï¼ˆIoCï¼‰å’Œä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰"><a href="#ä»€ä¹ˆæ˜¯æ§åˆ¶åè½¬ï¼ˆIoCï¼‰å’Œä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰" class="headerlink" title="ä»€ä¹ˆæ˜¯æ§åˆ¶åè½¬ï¼ˆIoCï¼‰å’Œä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰"></a>ä»€ä¹ˆæ˜¯æ§åˆ¶åè½¬ï¼ˆIoCï¼‰å’Œä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰</h4><blockquote><p>æ§åˆ¶åè½¬(IoC) å°±æ˜¯è¯´æŠŠåˆ›å»ºå¯¹è±¡çš„<strong>æ§åˆ¶æƒ</strong>è¿›è¡Œè½¬ç§»ï¼Œä»¥å‰åˆ›å»ºå¯¹è±¡çš„ä¸»åŠ¨æƒå’Œåˆ›å»ºæ—¶æœºæ˜¯ç”±è‡ªå·±æŠŠæ§çš„ï¼Œè€Œç°åœ¨è¿™ç§æƒåŠ›è½¬ç§»åˆ°ç¬¬ä¸‰æ–¹ï¼Œä¹Ÿå°±æ˜¯ <strong>Laravel</strong> ä¸­çš„å®¹å™¨ã€‚</p><p>  ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰åˆ™æ˜¯å¸®åŠ©å®¹å™¨å®ç°åœ¨è¿è¡Œä¸­åŠ¨æ€çš„ä¸ºå¯¹è±¡æä¾›æä¾èµ–çš„èµ„æºã€‚</p></blockquote><a id="more"></a><p>æ¦‚å¿µå®¹æ˜“ä¸å¤ªå®¹æ˜“è®©äººç†è§£ï¼Œä¸¾ä¸ªæ —å­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æˆ‘ä»¬æ„å»ºä¸€ä¸ªäººçš„ç±»å’Œä¸€ä¸ªç‹—çš„ç±»</span></span><br><span class="line"> <span class="class"><span class="keyword">class</span> <span class="title">People</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $dog = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&amp;gt;dog = <span class="keyword">new</span> Dog();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">putDog</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&amp;gt;dog-&amp;gt;dogCall();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Dog</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">dogCall</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'æ±ªæ±ªæ±ª'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªäººåœ¨é›ç‹—ï¼Œçªç„¶é‡åˆ°äº†æ­»å¯¹å¤´ï¼Œä»–äºæ˜¯æ”¾ç‹—å’¬äºº</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$people = <span class="keyword">new</span> People();</span><br><span class="line">$people-&gt;putDog();</span><br></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªæ“ä½œä¸­ï¼Œpeopleç±»è¦æ‰§è¡Œ<code>putDog()</code>è¿™ä¸ªæ–¹æ³•ï¼Œéœ€è¦ä¾èµ–Dogç±»ï¼Œä¸€èˆ¬æˆ‘ä»¬åƒä¸Šé¢ä¸€æ ·ï¼Œåœ¨peopleä¸­åˆ©ç”¨æ„é€ å‡½æ•°æ¥æ·»åŠ è¿™ä¸ªDogä¾èµ–ã€‚å¦‚æœä½¿ç”¨æ§åˆ¶åè½¬ ä¾èµ–æ³¨å…¥åˆ™æ˜¯è¿™ä¸ªæ ·å­</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">People</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> $dog = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">(Dog $dog)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&amp;gt;dog = $dog;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">putDog</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&amp;gt;dog-&amp;gt;dogCall();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Peopleç±»é€šè¿‡æ„é€ å‚æ•°å£°æ˜è‡ªå·±éœ€è¦çš„ ä¾èµ–ç±»ï¼Œç”±å®¹å™¨è‡ªåŠ¨æ³¨å…¥ã€‚è¿™æ ·å°±å®ç°äº†ç¨‹åºçš„æœ‰æ•ˆè§£è€¦ï¼Œå¥½å¤„åœ¨è¿™å°±ä¸å¤šè¯´äº†ã€‚</p><h2 id="Laravelå®¹å™¨ä¾èµ–æ³¨å…¥çš„å®ç°"><a href="#Laravelå®¹å™¨ä¾èµ–æ³¨å…¥çš„å®ç°" class="headerlink" title="Laravelå®¹å™¨ä¾èµ–æ³¨å…¥çš„å®ç°"></a>Laravelå®¹å™¨ä¾èµ–æ³¨å…¥çš„å®ç°</h2><h6 id="å®ç°åŸç†éœ€è¦äº†è§£çš„çŸ¥è¯†ç‚¹ï¼š"><a href="#å®ç°åŸç†éœ€è¦äº†è§£çš„çŸ¥è¯†ç‚¹ï¼š" class="headerlink" title="å®ç°åŸç†éœ€è¦äº†è§£çš„çŸ¥è¯†ç‚¹ï¼š"></a>å®ç°åŸç†éœ€è¦äº†è§£çš„çŸ¥è¯†ç‚¹ï¼š</h6><blockquote><p>é—­åŒ…ï¼ˆåŒ¿åå‡½æ•°ï¼‰ï¼š<br>åŒ¿åå‡½æ•°ï¼ˆAnonymous functionsï¼‰ï¼Œä¹Ÿå«é—­åŒ…å‡½æ•°ï¼ˆclosuresï¼‰ï¼Œå…è®¸ ä¸´æ—¶åˆ›å»ºä¸€ä¸ªæ²¡æœ‰æŒ‡å®šåç§°çš„å‡½æ•°</p><p>åå°„ï¼šPHP 5 ä»¥ä¸Šç‰ˆæœ¬å…·æœ‰å®Œæ•´çš„åå°„ APIï¼Œæ·»åŠ äº†å¯¹ç±»ã€æ¥å£ã€å‡½æ•°ã€æ–¹æ³•å’Œæ‰©å±•è¿›è¡Œåå‘å·¥ç¨‹çš„èƒ½åŠ›ã€‚ æ­¤å¤–ï¼Œåå°„ API æä¾›äº†æ–¹æ³•æ¥å–å‡ºå‡½æ•°ã€ç±»å’Œæ–¹æ³•ä¸­çš„æ–‡æ¡£æ³¨é‡Š</p></blockquote><h6 id="ç†è§£äº†é—­åŒ…å’Œåå°„çš„åŸºæœ¬ç”¨æ³•æˆ‘ä»¬æ¥çœ‹Laravelä¸­æ˜¯æ€ä¹ˆå®ç°å®¹å™¨çš„ï¼Œä¸‹é¢ä»£ç æ˜¯æˆ‘å¯¹laravelæ¡†æ¶å®¹å™¨éƒ¨åˆ†ä»£ç çš„ç®€åŒ–æ ¸å¿ƒç‰ˆï¼š"><a href="#ç†è§£äº†é—­åŒ…å’Œåå°„çš„åŸºæœ¬ç”¨æ³•æˆ‘ä»¬æ¥çœ‹Laravelä¸­æ˜¯æ€ä¹ˆå®ç°å®¹å™¨çš„ï¼Œä¸‹é¢ä»£ç æ˜¯æˆ‘å¯¹laravelæ¡†æ¶å®¹å™¨éƒ¨åˆ†ä»£ç çš„ç®€åŒ–æ ¸å¿ƒç‰ˆï¼š" class="headerlink" title="ç†è§£äº†é—­åŒ…å’Œåå°„çš„åŸºæœ¬ç”¨æ³•æˆ‘ä»¬æ¥çœ‹Laravelä¸­æ˜¯æ€ä¹ˆå®ç°å®¹å™¨çš„ï¼Œä¸‹é¢ä»£ç æ˜¯æˆ‘å¯¹laravelæ¡†æ¶å®¹å™¨éƒ¨åˆ†ä»£ç çš„ç®€åŒ–æ ¸å¿ƒç‰ˆï¼š"></a>ç†è§£äº†é—­åŒ…å’Œåå°„çš„åŸºæœ¬ç”¨æ³•æˆ‘ä»¬æ¥çœ‹Laravelä¸­æ˜¯æ€ä¹ˆå®ç°å®¹å™¨çš„ï¼Œä¸‹é¢ä»£ç æ˜¯æˆ‘å¯¹laravelæ¡†æ¶å®¹å™¨éƒ¨åˆ†ä»£ç çš„ç®€åŒ–æ ¸å¿ƒç‰ˆï¼š</h6><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Containerc</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">        *  å®¹å™¨ç»‘å®šï¼Œç”¨æ¥è£…æä¾›çš„å®ä¾‹æˆ–è€… æä¾›å®ä¾‹çš„å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="comment">        * <span class="doctag">@var</span> array</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    <span class="keyword">public</span> $building = [];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * æ³¨å†Œä¸€ä¸ªç»‘å®šåˆ°å®¹å™¨</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">bind</span><span class="params">($abstract, $concrete = null, $shared = false)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(is_null($concrete))&#123;</span><br><span class="line">            $concrete = $abstract;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!$concrete <span class="keyword">instanceOf</span> Closure)&#123;</span><br><span class="line">            $concrete = <span class="keyword">$this</span>-&amp;gt;getClosure($abstract, $concrete);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&amp;gt;building[$abstract] =  compact(<span class="string">"concrete"</span>, <span class="string">"shared"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ³¨å†Œä¸€ä¸ªå…±äº«çš„ç»‘å®š å•ä¾‹</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">singleton</span><span class="params">($abstract, $concrete, $shared = true)</span></span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&amp;gt;bind($abstract, $concrete, $shared);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * é»˜è®¤ç”Ÿæˆå®ä¾‹çš„å›è°ƒé—­åŒ…</span></span><br><span class="line"><span class="comment">        *</span></span><br><span class="line"><span class="comment">        * <span class="doctag">@param</span> $abstract</span></span><br><span class="line"><span class="comment">        * <span class="doctag">@param</span> $concrete</span></span><br><span class="line"><span class="comment">        * <span class="doctag">@return</span> Closure</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getClosure</span><span class="params">($abstract, $concrete)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">($c)</span> <span class="title">use</span><span class="params">($abstract, $concrete)</span></span>&#123;</span><br><span class="line">            $method = ($abstract == $concrete)? <span class="string">'build'</span> : <span class="string">'make'</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> $c-&amp;gt;$method($concrete);</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * ç”Ÿæˆå®ä¾‹ </span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">make</span><span class="params">($abstract)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $concrete = <span class="keyword">$this</span>-&amp;gt;getConcrete($abstract);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&amp;gt;isBuildable($concrete, $abstract))&#123;</span><br><span class="line">            $object = <span class="keyword">$this</span>-&amp;gt;build($concrete);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $object = <span class="keyword">$this</span>-&amp;gt;make($concrete);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $object;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * è·å–ç»‘å®šçš„å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getConcrete</span><span class="params">($abstract)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(! <span class="keyword">isset</span>(<span class="keyword">$this</span>-&amp;gt;building[$abstract]))&#123;</span><br><span class="line">            <span class="keyword">return</span> $abstract;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&amp;gt;building[$abstract][<span class="string">'concrete'</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * åˆ¤æ–­ æ˜¯å¦ å¯ä»¥åˆ›å»ºæœåŠ¡å®ä½“</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">isBuildable</span><span class="params">($concrete, $abstract)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> $concrete === $abstract || $concrete <span class="keyword">instanceof</span> Closure;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">        * æ ¹æ®å®ä¾‹å…·ä½“åç§°å®ä¾‹å…·ä½“å¯¹è±¡</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">build</span><span class="params">($concrete)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>($concrete <span class="keyword">instanceof</span> Closure)&#123;</span><br><span class="line">            <span class="keyword">return</span> $concrete(<span class="keyword">$this</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ›å»ºåå°„å¯¹è±¡</span></span><br><span class="line">        $reflector = <span class="keyword">new</span> ReflectionClass($concrete);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>( ! $reflector-&amp;gt;isInstantiable())&#123;</span><br><span class="line">            <span class="comment">//æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> \<span class="keyword">Exception</span>(<span class="string">'æ— æ³•å®ä¾‹åŒ–'</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $constructor = $reflector-&amp;gt;getConstructor();</span><br><span class="line">        <span class="keyword">if</span>(is_null($constructor))&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> $concrete;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        $dependencies = $constructor-&amp;gt;getParameters();</span><br><span class="line">        $instance = <span class="keyword">$this</span>-&amp;gt;getDependencies($dependencies);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $reflector-&amp;gt;newInstanceArgs($instance);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é€šè¿‡åå°„è§£å†³å‚æ•°ä¾èµ–</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">getDependencies</span><span class="params">(array $dependencies)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        $results = [];</span><br><span class="line">        <span class="keyword">foreach</span>( $dependencies <span class="keyword">as</span> $dependency )&#123;</span><br><span class="line">            $results[] = is_null($dependency-&amp;gt;getClass())</span><br><span class="line">                ?<span class="keyword">$this</span>-&amp;gt;resolvedNonClass($dependency)</span><br><span class="line">                :<span class="keyword">$this</span>-&amp;gt;resolvedClass($dependency);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> $results;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è§£å†³ä¸€ä¸ªæ²¡æœ‰ç±»å‹æç¤ºä¾èµ–</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">resolvedNonClass</span><span class="params">(ReflectionParameter $parameter)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>($parameter-&amp;gt;isDefaultValueAvailable())&#123;</span><br><span class="line">            <span class="keyword">return</span> $parameter-&amp;gt;getDefaultValue();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> \<span class="keyword">Exception</span>(<span class="string">'å‡ºé”™'</span>);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//é€šè¿‡å®¹å™¨è§£å†³ä¾èµ–</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">resolvedClass</span><span class="params">(ReflectionParameter $parameter)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&amp;gt;make($parameter-&amp;gt;getClass()-&amp;gt;name);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="å®¹å™¨çš„å·¥ä½œæµç¨‹"><a href="#å®¹å™¨çš„å·¥ä½œæµç¨‹" class="headerlink" title="å®¹å™¨çš„å·¥ä½œæµç¨‹"></a>å®¹å™¨çš„å·¥ä½œæµç¨‹</h4><p>æ¥ç€ä¸Šé¢é›ç‹—çš„ä¾‹å­ï¼š</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//å®ä¾‹åŒ–å®¹å™¨ç±»</span></span><br><span class="line">$app =  <span class="keyword">new</span> Container();</span><br><span class="line"><span class="comment">//å‘å®¹å™¨ä¸­å¡«å……Dog</span></span><br><span class="line">$app-&amp;gt;bind(<span class="string">'Dog'</span>,<span class="string">'App\Dog'</span>);</span><br><span class="line"><span class="comment">//å¡«å……People</span></span><br><span class="line">$app-&amp;gt;bind(<span class="string">'People'</span>, <span class="string">'App\People'</span>);</span><br><span class="line"><span class="comment">//é€šè¿‡å®¹å™¨å®ç°ä¾èµ–æ³¨å…¥ï¼Œå®Œæˆç±»çš„å®ä¾‹åŒ–ï¼›</span></span><br><span class="line">$people = $app-&amp;gt;make(<span class="string">'People'</span>);</span><br><span class="line"><span class="comment">//è°ƒç”¨æ–¹æ³•</span></span><br><span class="line"><span class="keyword">echo</span> $people-&amp;gt;putDog();</span><br></pre></td></tr></table></figure><p>ä¸Šé¢ç¤ºä¾‹ä¸­æˆ‘ä»¬å…ˆå®ä¾‹åŒ–å®¹å™¨ç±»ï¼Œç„¶åä½¿ç”¨<code>bind()</code>æ–¹æ³• ç»‘å®šæ¥å£å’Œ ç”Ÿæˆç›¸åº”çš„å®ä¾‹çš„é—­åŒ…å‡½æ•°ã€‚ç„¶åä½¿ç”¨<code>make()</code> å‡½æ•°ç”Ÿæˆå®ä¾‹å¯¹è±¡ï¼Œåœ¨<code>make()</code>ä¸­ä¼šè°ƒç”¨ <code>isBuildable($concrete, $abstract)</code> æ¥åˆ¤æ–­ ç»™å®šçš„æœåŠ¡å®ä½“ï¼ˆ<code>$concrete</code>å‚æ•°ï¼‰æ˜¯å¦å¯ä»¥åˆ›å»ºï¼Œå¯ä»¥åˆ›å»º å°±ä¼šè°ƒç”¨ <code>build($concrete)</code> å‡½æ•° ï¼Œ<code>build($concrete)</code> å‡½æ•°ä¼šåˆ¤æ–­ä¼ çš„å‚æ•°æ˜¯ æ˜¯<strong> é—­åŒ… </strong>è¿˜æ˜¯<strong> å…·ä½“ç±»å </strong>ï¼Œå¦‚æœæ˜¯é—­åŒ…åˆ™ç›´æ¥è¿è¡Œï¼Œå¦‚æœæ˜¯å…·ä½“ç±»åçš„è¯ï¼Œåˆ™é€šè¿‡åå°„è·å–è¯¥ç±»çš„æ„é€ å‡½æ•°æ‰€éœ€çš„ä¾èµ–ï¼Œå®Œæˆå®ä¾‹åŒ–ã€‚</p><p><strong>é‡ç‚¹ç†è§£ ä¸‹é¢è¿™å‡ ä¸ªå‡½æ•°ä¸­ åå°„çš„ç”¨æ³•ï¼Œåº”è¯¥å°±å¾ˆå¥½ç†è§£äº†</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">build($concrete)</span><br><span class="line">getDependencies(<span class="keyword">array</span> $dependencies)</span><br><span class="line">resolvedNonClass(ReflectionParameter $parameter)</span><br><span class="line">resolvedClass(ReflectionParameter $parameter)</span><br></pre></td></tr></table></figure><h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><blockquote><p>IoC ç†è§£èµ·æ¥æ˜¯æœ‰ç‚¹éš¾åº¦ï¼Œå¯èƒ½æ–‡ä¸­æè¿°è®©ä½ æ„Ÿè§‰ä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œå¯ä»¥å°†æ–‡ä¸­ä»£ç  åœ¨phpä¸­ç”¨debugè§‚å¯Ÿ è¿è¡ŒçŠ¶æ€ã€‚<br>  ç†è§£äº†å®¹å™¨çš„å…·ä½“å®ç°åŸç†ï¼Œå†å»çœ‹Laravelä¸­çš„ç›¸å…³å®ç°ï¼Œå°±ä¼šæ„Ÿè§‰è±ç„¶å¼€æœ—ã€‚</p></blockquote>]]></content>
      
      <categories>
          
          <category> Laravel </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Laravel </tag>
            
            <tag> php </tag>
            
        </tags>
      
    </entry>
    
  
  
</search>
